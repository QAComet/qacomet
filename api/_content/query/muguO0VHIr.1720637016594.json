{"_path":"/playwright/architecture","_dir":"playwright","_draft":false,"_partial":false,"_locale":"","title":"Architecture of Playwright","description":"In this post we dive into how Playwright initializes itself when you import anything from the library. If you look under the hood there is some complex machinery generating the API making it difficult for someone unfamiliar to get started with Playwright's internals.","breadcrumbs":[{"name":"Playwright","path":"/playwright/"},{"name":"Architecture","path":"/playwright/architecture/"}],"link":"/playwright/architecture/","created":{"string":"March 11, 2024","valueOf":1710136800000,"month":"Mar","day":11,"year":2024},"shortDescription":"Let's dive into Playwright's internals by looking at how the project is structured and discover its essential components.","body":{"type":"root","children":[{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"img","props":{"alt":"Diagram of Playwright's architecture","src":"/img/playwright/architecture_diagram.jpg"},"children":[]}]},{"type":"element","tag":"h2","props":{"id":"intro"},"children":[{"type":"text","value":"Intro"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"When you load up the "},{"type":"element","tag":"a","props":{"href":"https://github.com/microsoft/playwright","rel":["nofollow"]},"children":[{"type":"text","value":"repository"}]},{"type":"text","value":" for the Playwright library, you may be overwhelmed by the numerous packages living both inside the "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"packages"}]},{"type":"text","value":" folder, and within the root folder. In addition, if you try and trace the code used by a Playwright test, you will likely be befuddled by the many folders in the package which may or may not contain the code you are looking for, such as finding the definitions of the code in the import"}]},{"type":"element","tag":"pre","props":{"className":"language-ts shiki shiki-themes github-dark","code":"import { test, chromium } from \"@playwright/test\";\n","filename":"example-script.ts","language":"ts","meta":"","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F97583"},"children":[{"type":"text","value":"import"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E1E4E8"},"children":[{"type":"text","value":" { test, chromium } "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F97583"},"children":[{"type":"text","value":"from"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECBFF"},"children":[{"type":"text","value":" \"@playwright/test\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E1E4E8"},"children":[{"type":"text","value":";\n"}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"making it much more difficult to understand the core architecture of the playwright project. In this post we aim to remedy this problem by giving a high-level overview of the project and its architecture. This includes a description of what features and facets are contained within the various directories of the project, helping guide you to further your understanding of the project."}]},{"type":"element","tag":"h2","props":{"id":"root-directory"},"children":[{"type":"text","value":"Root directory"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"In the root directory we find the following folders"}]},{"type":"element","tag":"pre","props":{"className":"language-console shiki shiki-themes github-dark","code":"browser_patches/\ndocs/\nexamples/\npackages/\ntests/\nutils/\n","filename":"playwright/","language":"console","meta":"","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"browser_patches/\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"docs/\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"examples/\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"packages/\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"tests/\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":6},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"utils/\n"}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"along with the "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"package.json"}]},{"type":"text","value":" which includes the following keys"}]},{"type":"element","tag":"pre","props":{"className":"language-json shiki shiki-themes github-dark","code":"{\n  \"name\": \"playwright-internal\",\n  \"private\": true,\n  \"workspaces\": [\"packages/*\"]\n}\n","filename":"package.json","language":"json","meta":"","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#E1E4E8"},"children":[{"type":"text","value":"{\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#79B8FF"},"children":[{"type":"text","value":"  \"name\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E1E4E8"},"children":[{"type":"text","value":": "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECBFF"},"children":[{"type":"text","value":"\"playwright-internal\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E1E4E8"},"children":[{"type":"text","value":",\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#79B8FF"},"children":[{"type":"text","value":"  \"private\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E1E4E8"},"children":[{"type":"text","value":": "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#79B8FF"},"children":[{"type":"text","value":"true"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E1E4E8"},"children":[{"type":"text","value":",\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#79B8FF"},"children":[{"type":"text","value":"  \"workspaces\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E1E4E8"},"children":[{"type":"text","value":": ["}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECBFF"},"children":[{"type":"text","value":"\"packages/*\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E1E4E8"},"children":[{"type":"text","value":"]\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#E1E4E8"},"children":[{"type":"text","value":"}\n"}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"The "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"package.json"}]},{"type":"text","value":" gives us the hint the core functionality is within the "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"packages/"}]},{"type":"text","value":" directory since the root "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"package.json"}]},{"type":"text","value":" file is labelled private, has \"internal\" in its name, and uses the "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"\"workspaces\""}]},{"type":"text","value":" key, which tells node this project has multiple packages. Let's go over the other top-level directories real quick before diving into the "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"packages/"}]},{"type":"text","value":" folder"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"browser_patches"}]},{"type":"text","value":" - This folder contains browser patches improving adding additional controls and features to some of the browser engines used within this project. Interestingly, this give a patch to webkit so it can run within Windows."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"docs"}]},{"type":"text","value":" - The docs folder contains markdown files which compile to the documentation found on "},{"type":"element","tag":"a","props":{"href":"https://playwright.dev/docs/intro","rel":["nofollow"]},"children":[{"type":"text","value":"the Playwright docs"}]},{"type":"text","value":"."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"examples"}]},{"type":"text","value":" - Here are examples of test scripts to refer to, while getting started with using the Playwright project."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"tests"}]},{"type":"text","value":" - Even testing libraries should have automated tests, which are written in Playwright."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"utils"}]},{"type":"text","value":" - The utils directory contains miscellaneous tools used during build time, docker images, functionality for Azure, a types file generator, and more."}]}]},{"type":"element","tag":"h2","props":{"id":"packages-directory"},"children":[{"type":"text","value":"Packages directory"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"The packages directory contains over 20 separate packages, making it more difficult to understand. We will split up this list into easy-to-understand partitions."}]},{"type":"element","tag":"h3","props":{"id":"test-reportinggeneration-packages"},"children":[{"type":"text","value":"Test reporting/generation packages"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Playwright contains many different test reporting packages each with their own set of functionalities. Briefly, the list of packages in this category is"}]},{"type":"element","tag":"pre","props":{"className":"language-console shiki shiki-themes github-dark","code":"html-reporter/\nrecorder/\ntrace-viewer/\ntrace/\nweb/\n","filename":"playwright/packages","language":"console","meta":"","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"html-reporter/\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"recorder/\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"trace-viewer/\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"trace/\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"web/\n"}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"which contains the code associated with either handling test reports or "},{"type":"element","tag":"a","props":{"href":"https://playwright.dev/docs/codegen-intro","rel":["nofollow"]},"children":[{"type":"text","value":"generating"}]},{"type":"text","value":" them with the recorder package. In addition, there is the "},{"type":"element","tag":"a","props":{"href":"https://playwright.dev/docs/trace-viewer","rel":["nofollow"]},"children":[{"type":"text","value":"trace and trace viewer"}]},{"type":"text","value":" which can be recorded during playwright test runs. In addition, the "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"web/"}]},{"type":"text","value":" package provides utilities shared across the various web-based tools listed here."}]},{"type":"element","tag":"h3","props":{"id":"browser-specialized-packages"},"children":[{"type":"text","value":"Browser specialized packages"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Each of the packages here are simply exports of the "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"playwright-core"}]},{"type":"text","value":" package along with an install script for the associated browser only. You can find them on npmjs, for example, "},{"type":"element","tag":"a","props":{"href":"https://www.npmjs.com/package/playwright-chromium","rel":["nofollow"]},"children":[{"type":"text","value":"playwright-chromium"}]},{"type":"text","value":" is its own package which has playwright specialized for only automating chromium."}]},{"type":"element","tag":"pre","props":{"className":"language-console shiki shiki-themes github-dark","code":"playwright-chromium/\nplaywright-firefox/\nplaywright-webkit/\n","filename":"playwright/packages","language":"console","meta":"","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"playwright-chromium/\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"playwright-firefox/\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"playwright-webkit/\n"}]}]}]}]},{"type":"element","tag":"h3","props":{"id":"browser-installation-packages"},"children":[{"type":"text","value":"Browser installation packages"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"The packages listed here only include install scripts for each of the browsers. For example, "},{"type":"element","tag":"a","props":{"href":"https://www.npmjs.com/package/@playwright/browser-chromium","rel":["nofollow"]},"children":[{"type":"text","value":"playwright-browser-chromium"}]},{"type":"text","value":" corresponds to the "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"@playwright/browser-chromium"}]},{"type":"text","value":" package on npmjs."}]},{"type":"element","tag":"pre","props":{"className":"language-console shiki shiki-themes github-dark","code":"playwright-browser-chromium/\nplaywright-browser-firefox/\nplaywright-browser-webkit/\n","filename":"playwright/packages","language":"console","meta":"","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"playwright-browser-chromium/\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"playwright-browser-firefox/\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"playwright-browser-webkit/\n"}]}]}]}]},{"type":"element","tag":"h3","props":{"id":"component-testing-packages"},"children":[{"type":"text","value":"Component testing packages"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"These packages are all associated to the "},{"type":"element","tag":"a","props":{"href":"https://playwright.dev/docs/test-components","rel":["nofollow"]},"children":[{"type":"text","value":"experimental component testing framework"}]},{"type":"text","value":" in playwright. These give functionality to playwright similar to how Jest can render individual components for different libraries."}]},{"type":"element","tag":"pre","props":{"className":"language-console shiki shiki-themes github-dark","code":"playwright-ct-core/\nplaywright-ct-react/\nplaywright-ct-react17/\nplaywright-ct-solid/\nplaywright-ct-svelte/\nplaywright-ct-vue/\nplaywright-ct-vue2/\n","filename":"playwright/packages","language":"console","meta":"","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"playwright-ct-core/\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"playwright-ct-react/\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"playwright-ct-react17/\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"playwright-ct-solid/\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"playwright-ct-svelte/\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":6},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"playwright-ct-vue/\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":7},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"playwright-ct-vue2/\n"}]}]}]}]},{"type":"element","tag":"h3","props":{"id":"core-functionality-packages"},"children":[{"type":"text","value":"Core functionality packages"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Finally, we reach the core packages provided in playwright, which contain all of the main functionality of the playwright project."}]},{"type":"element","tag":"pre","props":{"className":"language-console shiki shiki-themes github-dark","code":"playwright-core/\nplaywright-test/\nplaywright/\nprotocol/\n","filename":"playwright/packages","language":"console","meta":"","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"playwright-core/\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"playwright-test/\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"playwright/\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"protocol/\n"}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Note the "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"playwright-test"}]},{"type":"text","value":" folder is simply a wrapper for binding "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"playwright-core"}]},{"type":"text","value":" and "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"playwright"}]},{"type":"text","value":" together in the "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"@playwright/test"}]},{"type":"text","value":" package installable through npm. If you look in the "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"index.js"}]},{"type":"text","value":" file, all you'll see is an export of "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"playwright/test"}]},{"type":"text","value":", which lives in the "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"playwright"}]},{"type":"text","value":" package."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Another package to look at briefly is the "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"protocol"}]},{"type":"text","value":" package which has automatically generated code through some of the build scripts in the "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"utils"}]},{"type":"text","value":" directory of the root directory of the playwright project. This simply contains a YAML file, "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"protocol.yml"}]},{"type":"text","value":", which lists out all the interfaces used by playwright's protocol. If you ever wanted to build a driver for playwright in another language, this is one of the core files to consult while building this library."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Now, the two main packages of the entire playwright library are the "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"playwright"}]},{"type":"text","value":" and "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"playwrite-core"}]},{"type":"text","value":" packages. The first of which is a wrapper around "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"playwright-core"}]},{"type":"text","value":" and is responsible for managing all the testing logic. This includes starting up test workers, running test executions, reporting test results, managing retries, and test assertions. A good heuristic for the code contained in this package is any kind of configuration logic you would find in the "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"playwright.config.ts"}]},{"type":"text","value":" file, or any of the associated test running code, such as"}]},{"type":"element","tag":"pre","props":{"className":"language-ts shiki shiki-themes github-dark","code":"import { test } from \"@playwright/test\";\n","filename":"my-test.spec.ts","language":"ts","meta":"","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F97583"},"children":[{"type":"text","value":"import"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E1E4E8"},"children":[{"type":"text","value":" { test } "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F97583"},"children":[{"type":"text","value":"from"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECBFF"},"children":[{"type":"text","value":" \"@playwright/test\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E1E4E8"},"children":[{"type":"text","value":";\n"}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"then you are likely importing code from the "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"playwright"}]},{"type":"text","value":" package."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"The other main package is "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"playwright-core"}]},{"type":"text","value":" which contains all of the browser automation functionality. This functionality is split up into two main components, the "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"client"}]},{"type":"text","value":" library and the "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"server"}]},{"type":"text","value":" library. The "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"server"}]},{"type":"text","value":" library, found in "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"packages/playwright-core/src/server"}]},{"type":"text","value":", contains all the logic responsible for the browser automation actions. This means it will dispatch actions over the "},{"type":"element","tag":"a","props":{"href":"https://chromedevtools.github.io/devtools-protocol/","rel":["nofollow"]},"children":[{"type":"text","value":"Chrome Devtools Protocol"}]},{"type":"text","value":" (CDP), or something similar to it, which tells the browser to perform actions like \"click the login button\", \"input 'Hello' into the text form\", or \"navigate to '"},{"type":"element","tag":"a","props":{"href":"https://news.ycombinator.com","rel":["nofollow"]},"children":[{"type":"text","value":"https://news.ycombinator.com"}]},{"type":"text","value":"'\". The "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"server"}]},{"type":"text","value":" library contains implementations for each of the supported browsers and provides a unified API provided by a websocket server for other processes to access this automation functionality."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"On the other hand, the "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"client"}]},{"type":"text","value":" library contains all the user facing API's you would access while writing any browser automation scripts. So if you have a script like"}]},{"type":"element","tag":"pre","props":{"className":"language-ts shiki shiki-themes github-dark","code":"import { chromium } from \"@playwright/test\";\n\n(async function () {\n  const browser = await chromium.launch({ headless: false });\n  const page = await browser.newPage();\n  await page.goto(\"https://playwright.dev\");\n})();\n","filename":"my-automation-script.ts","language":"ts","meta":"","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F97583"},"children":[{"type":"text","value":"import"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E1E4E8"},"children":[{"type":"text","value":" { chromium } "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F97583"},"children":[{"type":"text","value":"from"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECBFF"},"children":[{"type":"text","value":" \"@playwright/test\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E1E4E8"},"children":[{"type":"text","value":";\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#E1E4E8"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F97583"},"children":[{"type":"text","value":"async"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F97583"},"children":[{"type":"text","value":" function"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E1E4E8"},"children":[{"type":"text","value":" () {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F97583"},"children":[{"type":"text","value":"  const"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#79B8FF"},"children":[{"type":"text","value":" browser"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F97583"},"children":[{"type":"text","value":" ="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F97583"},"children":[{"type":"text","value":" await"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E1E4E8"},"children":[{"type":"text","value":" chromium."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#B392F0"},"children":[{"type":"text","value":"launch"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E1E4E8"},"children":[{"type":"text","value":"({ headless: "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#79B8FF"},"children":[{"type":"text","value":"false"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E1E4E8"},"children":[{"type":"text","value":" });\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F97583"},"children":[{"type":"text","value":"  const"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#79B8FF"},"children":[{"type":"text","value":" page"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F97583"},"children":[{"type":"text","value":" ="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F97583"},"children":[{"type":"text","value":" await"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E1E4E8"},"children":[{"type":"text","value":" browser."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#B392F0"},"children":[{"type":"text","value":"newPage"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E1E4E8"},"children":[{"type":"text","value":"();\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":6},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F97583"},"children":[{"type":"text","value":"  await"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E1E4E8"},"children":[{"type":"text","value":" page."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#B392F0"},"children":[{"type":"text","value":"goto"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E1E4E8"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECBFF"},"children":[{"type":"text","value":"\"https://playwright.dev\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E1E4E8"},"children":[{"type":"text","value":");\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":7},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#E1E4E8"},"children":[{"type":"text","value":"})();\n"}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"really you are importing "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"chromium"}]},{"type":"text","value":" from an instance of the class in "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"playwright-core/client/playwright"}]},{"type":"text","value":". Then, calling "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"browser.newPage"}]},{"type":"text","value":" and "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"page.goto"}]},{"type":"text","value":" is making requests to interfaces in the "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"server"}]},{"type":"text","value":" library, which communicates with the browsers over CDP or something similar. This means if you ever wanted to write your own browser automation tool which is browser-independent, a useful starting point would be to use the "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"server"}]},{"type":"text","value":" library in the "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"playwright-core"}]},{"type":"text","value":" package since it provides a comprehensive and battle tested API for this kind of functionality."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"This splitting of responsibility design pattern works well because it allows for "},{"type":"element","tag":"a","props":{"href":"https://github.com/microsoft/playwright-python","rel":["nofollow"]},"children":[{"type":"text","value":"supporting"}]},{"type":"text","value":" "},{"type":"element","tag":"a","props":{"href":"https://github.com/microsoft/playwright-java/","rel":["nofollow"]},"children":[{"type":"text","value":"multiple"}]},{"type":"text","value":" "},{"type":"element","tag":"a","props":{"href":"https://github.com/microsoft/playwright-dotnet","rel":["nofollow"]},"children":[{"type":"text","value":"languages"}]},{"type":"text","value":" which can use Playwright's browser automation API. In fact, if you look at other implementations of the Playwright library, you will find the same design patterns (such as "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"ChannelOwner"}]},{"type":"text","value":") as you would in the the "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"client"}]},{"type":"text","value":" library found in "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"playwright-core"}]},{"type":"text","value":"."}]},{"type":"element","tag":"h2","props":{"id":"looking-beyond"},"children":[{"type":"text","value":"Looking beyond"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Hopefully you have a clearer picture about how the Playwright project is structured and have some intuition about where you can look if you ever want to extend its functionality or use it as a base library for some other browser-automation project."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"In later posts we will deep dive into more of the specific design patterns used in Playwright's codebase which allow it to work so well, enriching your understanding of how the library works."}]},{"type":"element","tag":"style","props":{},"children":[{"type":"text","value":"html .default .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}"}]}],"toc":{"title":"","searchDepth":2,"depth":2,"links":[{"id":"intro","depth":2,"text":"Intro"},{"id":"root-directory","depth":2,"text":"Root directory"},{"id":"packages-directory","depth":2,"text":"Packages directory","children":[{"id":"test-reportinggeneration-packages","depth":3,"text":"Test reporting/generation packages"},{"id":"browser-specialized-packages","depth":3,"text":"Browser specialized packages"},{"id":"browser-installation-packages","depth":3,"text":"Browser installation packages"},{"id":"component-testing-packages","depth":3,"text":"Component testing packages"},{"id":"core-functionality-packages","depth":3,"text":"Core functionality packages"}]},{"id":"looking-beyond","depth":2,"text":"Looking beyond"}]}},"_type":"markdown","_id":"content:playwright:architecture.md","_source":"content","_file":"playwright/architecture.md","_extension":"md"}