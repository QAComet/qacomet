[{"data":1,"prerenderedAt":4041},["Reactive",2],{"blog-post-playwright/how-playwright-initializes":3},{"_path":4,"_dir":5,"_draft":6,"_partial":6,"_locale":7,"title":8,"description":9,"breadcrumbs":10,"image":16,"shortDescription":17,"created":18,"link":4,"body":24,"_type":4036,"_id":4037,"_source":4038,"_file":4039,"_extension":4040},"/playwright/how-playwright-initializes","playwright",false,"","How importing from Playwright works","In this post we dive into how Playwright initializes itself when you import anything from the library. If you look under the hood there is some complex machinery generating the API making it difficult for someone unfamiliar to get started with Playwright's internals.",[11,14],{"name":12,"path":13},"Playwright","/playwright",{"name":15,"path":4},"How Playwright Initializes","img","Importing from playwright is a complex process with many interacting components. Let's look under the hood to discover how playwright-core is structured.",{"string":19,"number":20,"month":21,"day":22,"year":23},"March 13, 2024",1710309600000,"Mar",13,2024,{"type":25,"children":26,"toc":4030},"root",[27,37,97,118,179,247,284,291,303,1207,1214,1271,1350,1369,1424,1429,1460,1487,1552,1589,1786,1852,1975,2016,2219,2267,2309,2328,2618,2669,2855,2875,3321,3407,3486,3564,3629,3635,3648,3751,3786,3811,3824,4012,4024],{"type":28,"tag":29,"props":30,"children":31},"element","p",{},[32],{"type":28,"tag":16,"props":33,"children":36},{"alt":34,"src":35},"Diagram of playwright-core initialization process","/img/playwright/playwright-core_initialization_diagram.jpg",[],{"type":28,"tag":29,"props":38,"children":39},{},[40,43,50,52,58,60,66,68,73,75,81,83,88,90,95],{"type":41,"value":42},"text","Whenever you import playwright, there's a lot happening under the hood because of how the project is structured. When you import from ",{"type":28,"tag":44,"props":45,"children":47},"code",{"className":46},[],[48],{"type":41,"value":49},"@playwright/test",{"type":41,"value":51}," this actually merges two separate packages in the playwright project. They are ",{"type":28,"tag":44,"props":53,"children":55},{"className":54},[],[56],{"type":41,"value":57},"packages/playwright-core",{"type":41,"value":59}," and ",{"type":28,"tag":44,"props":61,"children":63},{"className":62},[],[64],{"type":41,"value":65},"packages/playwright",{"type":41,"value":67},". When you import ",{"type":28,"tag":44,"props":69,"children":71},{"className":70},[],[72],{"type":41,"value":49},{"type":41,"value":74}," you are importing the export ",{"type":28,"tag":44,"props":76,"children":78},{"className":77},[],[79],{"type":41,"value":80},"require('playwright/test')",{"type":41,"value":82},", which contains the merging code. Here is where the wrapper code in ",{"type":28,"tag":44,"props":84,"children":86},{"className":85},[],[87],{"type":41,"value":65},{"type":41,"value":89}," is combined with the browser automation code in ",{"type":28,"tag":44,"props":91,"children":93},{"className":92},[],[94],{"type":41,"value":57},{"type":41,"value":96},".",{"type":28,"tag":29,"props":98,"children":99},{},[100,102,108,110,116],{"type":41,"value":101},"The import from ",{"type":28,"tag":44,"props":103,"children":105},{"className":104},[],[106],{"type":41,"value":107},"playwright-core",{"type":41,"value":109}," is much more complex because the export is dynamically generated from a function. Looking at the ",{"type":28,"tag":44,"props":111,"children":113},{"className":112},[],[114],{"type":41,"value":115},"index.js",{"type":41,"value":117}," file gives an export",{"type":28,"tag":119,"props":120,"children":125},"pre",{"className":121,"code":122,"filename":123,"language":124,"meta":7,"style":7},"language-js shiki shiki-themes github-dark","module.exports = require('./lib/inprocess');\n","packages/playwright-core/index.js","js",[126],{"type":28,"tag":44,"props":127,"children":128},{"__ignoreMap":7},[129],{"type":28,"tag":130,"props":131,"children":134},"span",{"class":132,"line":133},"line",1,[135,141,146,151,157,163,168,174],{"type":28,"tag":130,"props":136,"children":138},{"style":137},"--shiki-default:#79B8FF",[139],{"type":41,"value":140},"module",{"type":28,"tag":130,"props":142,"children":144},{"style":143},"--shiki-default:#E1E4E8",[145],{"type":41,"value":96},{"type":28,"tag":130,"props":147,"children":148},{"style":137},[149],{"type":41,"value":150},"exports",{"type":28,"tag":130,"props":152,"children":154},{"style":153},"--shiki-default:#F97583",[155],{"type":41,"value":156}," =",{"type":28,"tag":130,"props":158,"children":160},{"style":159},"--shiki-default:#B392F0",[161],{"type":41,"value":162}," require",{"type":28,"tag":130,"props":164,"children":165},{"style":143},[166],{"type":41,"value":167},"(",{"type":28,"tag":130,"props":169,"children":171},{"style":170},"--shiki-default:#9ECBFF",[172],{"type":41,"value":173},"'./lib/inprocess'",{"type":28,"tag":130,"props":175,"children":176},{"style":143},[177],{"type":41,"value":178},");\n",{"type":28,"tag":29,"props":180,"children":181},{},[182,184,190,192,198,200,206,208,214,216,222,224,229,231,237,239,245],{"type":41,"value":183},"Note the ",{"type":28,"tag":44,"props":185,"children":187},{"className":186},[],[188],{"type":41,"value":189},"lib",{"type":41,"value":191}," directory is just the ",{"type":28,"tag":44,"props":193,"children":195},{"className":194},[],[196],{"type":41,"value":197},"src",{"type":41,"value":199}," directory after playwright runs its build script, and is what's found in the npm package. The ",{"type":28,"tag":44,"props":201,"children":203},{"className":202},[],[204],{"type":41,"value":205},"inprocess.ts",{"type":41,"value":207}," file just imports from the adjacent ",{"type":28,"tag":44,"props":209,"children":211},{"className":210},[],[212],{"type":41,"value":213},"inProcessFactory.ts",{"type":41,"value":215}," and executes the function from there, called ",{"type":28,"tag":44,"props":217,"children":219},{"className":218},[],[220],{"type":41,"value":221},"createInProcessPlaywright",{"type":41,"value":223},". We include the source below in its own section, but note ",{"type":28,"tag":44,"props":225,"children":227},{"className":226},[],[228],{"type":41,"value":221},{"type":41,"value":230}," is required to be called because it dynamically intiailizes the interface between the client library, defined in ",{"type":28,"tag":44,"props":232,"children":234},{"className":233},[],[235],{"type":41,"value":236},"src/client",{"type":41,"value":238},", and the server library, defined in ",{"type":28,"tag":44,"props":240,"children":242},{"className":241},[],[243],{"type":41,"value":244},"src/server",{"type":41,"value":246},". The server library is responsible for dispatching browser automation actions over a browser automation protocol, such as the Chrome Devtools Protocol, abbreviated as CDP, while the client library gives a public API for playwright users to interact with the server library.",{"type":28,"tag":29,"props":248,"children":249},{},[250,252,261,263,268,270,275,277,282],{"type":41,"value":251},"There is the separation of logic here, between client and server, because it allows for implementations of the client library in multiple languages. For example, if you look in the ",{"type":28,"tag":253,"props":254,"children":258},"a",{"href":255,"rel":256},"https://github.com/microsoft/playwright-python",[257],"nofollow",[259],{"type":41,"value":260},"playwright-python",{"type":41,"value":262}," source code, you will find a very similar library to the ",{"type":28,"tag":44,"props":264,"children":266},{"className":265},[],[267],{"type":41,"value":236},{"type":41,"value":269}," library found in the ",{"type":28,"tag":44,"props":271,"children":273},{"className":272},[],[274],{"type":41,"value":107},{"type":41,"value":276}," package. We will mention some of the common design patterns used in the playwright client libraries which are also used in the ",{"type":28,"tag":44,"props":278,"children":280},{"className":279},[],[281],{"type":41,"value":107},{"type":41,"value":283}," client library below.",{"type":28,"tag":285,"props":286,"children":288},"h2",{"id":287},"inprocessfactory",[289],{"type":41,"value":290},"inProcessFactory",{"type":28,"tag":29,"props":292,"children":293},{},[294,296,301],{"type":41,"value":295},"This file contains only one function, the ",{"type":28,"tag":44,"props":297,"children":299},{"className":298},[],[300],{"type":41,"value":221},{"type":41,"value":302}," function, which we include here:",{"type":28,"tag":119,"props":304,"children":309},{"className":305,"code":306,"filename":307,"language":308,"meta":7,"style":7},"language-ts shiki shiki-themes github-dark","export function createInProcessPlaywright(): PlaywrightAPI {\n  const playwright = createPlaywright({\n    sdkLanguage: (process.env.PW_LANG_NAME as Language | undefined) || 'javascript'\n  });\n\n  const clientConnection = new Connection(undefined, undefined);\n  clientConnection.useRawBuffers();\n  const dispatcherConnection = new DispatcherConnection(true /* local */);\n\n  // Dispatch synchronously at first.\n  dispatcherConnection.onmessage = message => clientConnection.dispatch(message);\n  clientConnection.onmessage = message => dispatcherConnection.dispatch(message);\n\n  const rootScope = new RootDispatcher(dispatcherConnection);\n\n  // Initialize Playwright channel.\n  new PlaywrightDispatcher(rootScope, playwright);\n  const playwrightAPI = clientConnection.getObjectWithKnownName('Playwright') as PlaywrightAPI;\n  playwrightAPI.chromium._serverLauncher = new BrowserServerLauncherImpl('chromium');\n  playwrightAPI.firefox._serverLauncher = new BrowserServerLauncherImpl('firefox');\n  playwrightAPI.webkit._serverLauncher = new BrowserServerLauncherImpl('webkit');\n  playwrightAPI._android._serverLauncher = new AndroidServerLauncherImpl();\n\n  // Switch to async dispatch after we got Playwright object.\n  dispatcherConnection.onmessage = message => setImmediate(() => clientConnection.dispatch(message));\n  clientConnection.onmessage = message => setImmediate(() => dispatcherConnection.dispatch(message));\n\n  clientConnection.toImpl = (x: any) => x\n    ? dispatcherConnection._dispatchers.get(x._guid)!._object\n    : dispatcherConnection._dispatchers.get('');\n  (playwrightAPI as any)._toImpl = clientConnection.toImpl;\n  return playwrightAPI;\n}\n","packages/playwright-core/src/inProcessFactory.ts","ts",[310],{"type":28,"tag":44,"props":311,"children":312},{"__ignoreMap":7},[313,351,379,428,437,447,496,515,560,568,577,621,658,665,696,704,713,732,785,821,855,889,915,923,932,984,1032,1040,1089,1123,1153,1184,1198],{"type":28,"tag":130,"props":314,"children":315},{"class":132,"line":133},[316,321,326,331,336,341,346],{"type":28,"tag":130,"props":317,"children":318},{"style":153},[319],{"type":41,"value":320},"export",{"type":28,"tag":130,"props":322,"children":323},{"style":153},[324],{"type":41,"value":325}," function",{"type":28,"tag":130,"props":327,"children":328},{"style":159},[329],{"type":41,"value":330}," createInProcessPlaywright",{"type":28,"tag":130,"props":332,"children":333},{"style":143},[334],{"type":41,"value":335},"()",{"type":28,"tag":130,"props":337,"children":338},{"style":153},[339],{"type":41,"value":340},":",{"type":28,"tag":130,"props":342,"children":343},{"style":159},[344],{"type":41,"value":345}," PlaywrightAPI",{"type":28,"tag":130,"props":347,"children":348},{"style":143},[349],{"type":41,"value":350}," {\n",{"type":28,"tag":130,"props":352,"children":354},{"class":132,"line":353},2,[355,360,365,369,374],{"type":28,"tag":130,"props":356,"children":357},{"style":153},[358],{"type":41,"value":359},"  const",{"type":28,"tag":130,"props":361,"children":362},{"style":137},[363],{"type":41,"value":364}," playwright",{"type":28,"tag":130,"props":366,"children":367},{"style":153},[368],{"type":41,"value":156},{"type":28,"tag":130,"props":370,"children":371},{"style":159},[372],{"type":41,"value":373}," createPlaywright",{"type":28,"tag":130,"props":375,"children":376},{"style":143},[377],{"type":41,"value":378},"({\n",{"type":28,"tag":130,"props":380,"children":382},{"class":132,"line":381},3,[383,388,393,398,403,408,413,418,423],{"type":28,"tag":130,"props":384,"children":385},{"style":143},[386],{"type":41,"value":387},"    sdkLanguage: (process.env.",{"type":28,"tag":130,"props":389,"children":390},{"style":137},[391],{"type":41,"value":392},"PW_LANG_NAME",{"type":28,"tag":130,"props":394,"children":395},{"style":153},[396],{"type":41,"value":397}," as",{"type":28,"tag":130,"props":399,"children":400},{"style":159},[401],{"type":41,"value":402}," Language",{"type":28,"tag":130,"props":404,"children":405},{"style":153},[406],{"type":41,"value":407}," |",{"type":28,"tag":130,"props":409,"children":410},{"style":137},[411],{"type":41,"value":412}," undefined",{"type":28,"tag":130,"props":414,"children":415},{"style":143},[416],{"type":41,"value":417},") ",{"type":28,"tag":130,"props":419,"children":420},{"style":153},[421],{"type":41,"value":422},"||",{"type":28,"tag":130,"props":424,"children":425},{"style":170},[426],{"type":41,"value":427}," 'javascript'\n",{"type":28,"tag":130,"props":429,"children":431},{"class":132,"line":430},4,[432],{"type":28,"tag":130,"props":433,"children":434},{"style":143},[435],{"type":41,"value":436},"  });\n",{"type":28,"tag":130,"props":438,"children":440},{"class":132,"line":439},5,[441],{"type":28,"tag":130,"props":442,"children":444},{"emptyLinePlaceholder":443},true,[445],{"type":41,"value":446},"\n",{"type":28,"tag":130,"props":448,"children":450},{"class":132,"line":449},6,[451,455,460,464,469,474,478,483,488,492],{"type":28,"tag":130,"props":452,"children":453},{"style":153},[454],{"type":41,"value":359},{"type":28,"tag":130,"props":456,"children":457},{"style":137},[458],{"type":41,"value":459}," clientConnection",{"type":28,"tag":130,"props":461,"children":462},{"style":153},[463],{"type":41,"value":156},{"type":28,"tag":130,"props":465,"children":466},{"style":153},[467],{"type":41,"value":468}," new",{"type":28,"tag":130,"props":470,"children":471},{"style":159},[472],{"type":41,"value":473}," Connection",{"type":28,"tag":130,"props":475,"children":476},{"style":143},[477],{"type":41,"value":167},{"type":28,"tag":130,"props":479,"children":480},{"style":137},[481],{"type":41,"value":482},"undefined",{"type":28,"tag":130,"props":484,"children":485},{"style":143},[486],{"type":41,"value":487},", ",{"type":28,"tag":130,"props":489,"children":490},{"style":137},[491],{"type":41,"value":482},{"type":28,"tag":130,"props":493,"children":494},{"style":143},[495],{"type":41,"value":178},{"type":28,"tag":130,"props":497,"children":499},{"class":132,"line":498},7,[500,505,510],{"type":28,"tag":130,"props":501,"children":502},{"style":143},[503],{"type":41,"value":504},"  clientConnection.",{"type":28,"tag":130,"props":506,"children":507},{"style":159},[508],{"type":41,"value":509},"useRawBuffers",{"type":28,"tag":130,"props":511,"children":512},{"style":143},[513],{"type":41,"value":514},"();\n",{"type":28,"tag":130,"props":516,"children":518},{"class":132,"line":517},8,[519,523,528,532,536,541,545,550,556],{"type":28,"tag":130,"props":520,"children":521},{"style":153},[522],{"type":41,"value":359},{"type":28,"tag":130,"props":524,"children":525},{"style":137},[526],{"type":41,"value":527}," dispatcherConnection",{"type":28,"tag":130,"props":529,"children":530},{"style":153},[531],{"type":41,"value":156},{"type":28,"tag":130,"props":533,"children":534},{"style":153},[535],{"type":41,"value":468},{"type":28,"tag":130,"props":537,"children":538},{"style":159},[539],{"type":41,"value":540}," DispatcherConnection",{"type":28,"tag":130,"props":542,"children":543},{"style":143},[544],{"type":41,"value":167},{"type":28,"tag":130,"props":546,"children":547},{"style":137},[548],{"type":41,"value":549},"true",{"type":28,"tag":130,"props":551,"children":553},{"style":552},"--shiki-default:#6A737D",[554],{"type":41,"value":555}," /* local */",{"type":28,"tag":130,"props":557,"children":558},{"style":143},[559],{"type":41,"value":178},{"type":28,"tag":130,"props":561,"children":563},{"class":132,"line":562},9,[564],{"type":28,"tag":130,"props":565,"children":566},{"emptyLinePlaceholder":443},[567],{"type":41,"value":446},{"type":28,"tag":130,"props":569,"children":571},{"class":132,"line":570},10,[572],{"type":28,"tag":130,"props":573,"children":574},{"style":552},[575],{"type":41,"value":576},"  // Dispatch synchronously at first.\n",{"type":28,"tag":130,"props":578,"children":580},{"class":132,"line":579},11,[581,586,591,595,601,606,611,616],{"type":28,"tag":130,"props":582,"children":583},{"style":143},[584],{"type":41,"value":585},"  dispatcherConnection.",{"type":28,"tag":130,"props":587,"children":588},{"style":159},[589],{"type":41,"value":590},"onmessage",{"type":28,"tag":130,"props":592,"children":593},{"style":153},[594],{"type":41,"value":156},{"type":28,"tag":130,"props":596,"children":598},{"style":597},"--shiki-default:#FFAB70",[599],{"type":41,"value":600}," message",{"type":28,"tag":130,"props":602,"children":603},{"style":153},[604],{"type":41,"value":605}," =>",{"type":28,"tag":130,"props":607,"children":608},{"style":143},[609],{"type":41,"value":610}," clientConnection.",{"type":28,"tag":130,"props":612,"children":613},{"style":159},[614],{"type":41,"value":615},"dispatch",{"type":28,"tag":130,"props":617,"children":618},{"style":143},[619],{"type":41,"value":620},"(message);\n",{"type":28,"tag":130,"props":622,"children":624},{"class":132,"line":623},12,[625,629,633,637,641,645,650,654],{"type":28,"tag":130,"props":626,"children":627},{"style":143},[628],{"type":41,"value":504},{"type":28,"tag":130,"props":630,"children":631},{"style":159},[632],{"type":41,"value":590},{"type":28,"tag":130,"props":634,"children":635},{"style":153},[636],{"type":41,"value":156},{"type":28,"tag":130,"props":638,"children":639},{"style":597},[640],{"type":41,"value":600},{"type":28,"tag":130,"props":642,"children":643},{"style":153},[644],{"type":41,"value":605},{"type":28,"tag":130,"props":646,"children":647},{"style":143},[648],{"type":41,"value":649}," dispatcherConnection.",{"type":28,"tag":130,"props":651,"children":652},{"style":159},[653],{"type":41,"value":615},{"type":28,"tag":130,"props":655,"children":656},{"style":143},[657],{"type":41,"value":620},{"type":28,"tag":130,"props":659,"children":660},{"class":132,"line":22},[661],{"type":28,"tag":130,"props":662,"children":663},{"emptyLinePlaceholder":443},[664],{"type":41,"value":446},{"type":28,"tag":130,"props":666,"children":668},{"class":132,"line":667},14,[669,673,678,682,686,691],{"type":28,"tag":130,"props":670,"children":671},{"style":153},[672],{"type":41,"value":359},{"type":28,"tag":130,"props":674,"children":675},{"style":137},[676],{"type":41,"value":677}," rootScope",{"type":28,"tag":130,"props":679,"children":680},{"style":153},[681],{"type":41,"value":156},{"type":28,"tag":130,"props":683,"children":684},{"style":153},[685],{"type":41,"value":468},{"type":28,"tag":130,"props":687,"children":688},{"style":159},[689],{"type":41,"value":690}," RootDispatcher",{"type":28,"tag":130,"props":692,"children":693},{"style":143},[694],{"type":41,"value":695},"(dispatcherConnection);\n",{"type":28,"tag":130,"props":697,"children":699},{"class":132,"line":698},15,[700],{"type":28,"tag":130,"props":701,"children":702},{"emptyLinePlaceholder":443},[703],{"type":41,"value":446},{"type":28,"tag":130,"props":705,"children":707},{"class":132,"line":706},16,[708],{"type":28,"tag":130,"props":709,"children":710},{"style":552},[711],{"type":41,"value":712},"  // Initialize Playwright channel.\n",{"type":28,"tag":130,"props":714,"children":716},{"class":132,"line":715},17,[717,722,727],{"type":28,"tag":130,"props":718,"children":719},{"style":153},[720],{"type":41,"value":721},"  new",{"type":28,"tag":130,"props":723,"children":724},{"style":159},[725],{"type":41,"value":726}," PlaywrightDispatcher",{"type":28,"tag":130,"props":728,"children":729},{"style":143},[730],{"type":41,"value":731},"(rootScope, playwright);\n",{"type":28,"tag":130,"props":733,"children":735},{"class":132,"line":734},18,[736,740,745,749,753,758,762,767,771,776,780],{"type":28,"tag":130,"props":737,"children":738},{"style":153},[739],{"type":41,"value":359},{"type":28,"tag":130,"props":741,"children":742},{"style":137},[743],{"type":41,"value":744}," playwrightAPI",{"type":28,"tag":130,"props":746,"children":747},{"style":153},[748],{"type":41,"value":156},{"type":28,"tag":130,"props":750,"children":751},{"style":143},[752],{"type":41,"value":610},{"type":28,"tag":130,"props":754,"children":755},{"style":159},[756],{"type":41,"value":757},"getObjectWithKnownName",{"type":28,"tag":130,"props":759,"children":760},{"style":143},[761],{"type":41,"value":167},{"type":28,"tag":130,"props":763,"children":764},{"style":170},[765],{"type":41,"value":766},"'Playwright'",{"type":28,"tag":130,"props":768,"children":769},{"style":143},[770],{"type":41,"value":417},{"type":28,"tag":130,"props":772,"children":773},{"style":153},[774],{"type":41,"value":775},"as",{"type":28,"tag":130,"props":777,"children":778},{"style":159},[779],{"type":41,"value":345},{"type":28,"tag":130,"props":781,"children":782},{"style":143},[783],{"type":41,"value":784},";\n",{"type":28,"tag":130,"props":786,"children":788},{"class":132,"line":787},19,[789,794,799,803,808,812,817],{"type":28,"tag":130,"props":790,"children":791},{"style":143},[792],{"type":41,"value":793},"  playwrightAPI.chromium._serverLauncher ",{"type":28,"tag":130,"props":795,"children":796},{"style":153},[797],{"type":41,"value":798},"=",{"type":28,"tag":130,"props":800,"children":801},{"style":153},[802],{"type":41,"value":468},{"type":28,"tag":130,"props":804,"children":805},{"style":159},[806],{"type":41,"value":807}," BrowserServerLauncherImpl",{"type":28,"tag":130,"props":809,"children":810},{"style":143},[811],{"type":41,"value":167},{"type":28,"tag":130,"props":813,"children":814},{"style":170},[815],{"type":41,"value":816},"'chromium'",{"type":28,"tag":130,"props":818,"children":819},{"style":143},[820],{"type":41,"value":178},{"type":28,"tag":130,"props":822,"children":824},{"class":132,"line":823},20,[825,830,834,838,842,846,851],{"type":28,"tag":130,"props":826,"children":827},{"style":143},[828],{"type":41,"value":829},"  playwrightAPI.firefox._serverLauncher ",{"type":28,"tag":130,"props":831,"children":832},{"style":153},[833],{"type":41,"value":798},{"type":28,"tag":130,"props":835,"children":836},{"style":153},[837],{"type":41,"value":468},{"type":28,"tag":130,"props":839,"children":840},{"style":159},[841],{"type":41,"value":807},{"type":28,"tag":130,"props":843,"children":844},{"style":143},[845],{"type":41,"value":167},{"type":28,"tag":130,"props":847,"children":848},{"style":170},[849],{"type":41,"value":850},"'firefox'",{"type":28,"tag":130,"props":852,"children":853},{"style":143},[854],{"type":41,"value":178},{"type":28,"tag":130,"props":856,"children":858},{"class":132,"line":857},21,[859,864,868,872,876,880,885],{"type":28,"tag":130,"props":860,"children":861},{"style":143},[862],{"type":41,"value":863},"  playwrightAPI.webkit._serverLauncher ",{"type":28,"tag":130,"props":865,"children":866},{"style":153},[867],{"type":41,"value":798},{"type":28,"tag":130,"props":869,"children":870},{"style":153},[871],{"type":41,"value":468},{"type":28,"tag":130,"props":873,"children":874},{"style":159},[875],{"type":41,"value":807},{"type":28,"tag":130,"props":877,"children":878},{"style":143},[879],{"type":41,"value":167},{"type":28,"tag":130,"props":881,"children":882},{"style":170},[883],{"type":41,"value":884},"'webkit'",{"type":28,"tag":130,"props":886,"children":887},{"style":143},[888],{"type":41,"value":178},{"type":28,"tag":130,"props":890,"children":892},{"class":132,"line":891},22,[893,898,902,906,911],{"type":28,"tag":130,"props":894,"children":895},{"style":143},[896],{"type":41,"value":897},"  playwrightAPI._android._serverLauncher ",{"type":28,"tag":130,"props":899,"children":900},{"style":153},[901],{"type":41,"value":798},{"type":28,"tag":130,"props":903,"children":904},{"style":153},[905],{"type":41,"value":468},{"type":28,"tag":130,"props":907,"children":908},{"style":159},[909],{"type":41,"value":910}," AndroidServerLauncherImpl",{"type":28,"tag":130,"props":912,"children":913},{"style":143},[914],{"type":41,"value":514},{"type":28,"tag":130,"props":916,"children":918},{"class":132,"line":917},23,[919],{"type":28,"tag":130,"props":920,"children":921},{"emptyLinePlaceholder":443},[922],{"type":41,"value":446},{"type":28,"tag":130,"props":924,"children":926},{"class":132,"line":925},24,[927],{"type":28,"tag":130,"props":928,"children":929},{"style":552},[930],{"type":41,"value":931},"  // Switch to async dispatch after we got Playwright object.\n",{"type":28,"tag":130,"props":933,"children":935},{"class":132,"line":934},25,[936,940,944,948,952,956,961,966,971,975,979],{"type":28,"tag":130,"props":937,"children":938},{"style":143},[939],{"type":41,"value":585},{"type":28,"tag":130,"props":941,"children":942},{"style":159},[943],{"type":41,"value":590},{"type":28,"tag":130,"props":945,"children":946},{"style":153},[947],{"type":41,"value":156},{"type":28,"tag":130,"props":949,"children":950},{"style":597},[951],{"type":41,"value":600},{"type":28,"tag":130,"props":953,"children":954},{"style":153},[955],{"type":41,"value":605},{"type":28,"tag":130,"props":957,"children":958},{"style":159},[959],{"type":41,"value":960}," setImmediate",{"type":28,"tag":130,"props":962,"children":963},{"style":143},[964],{"type":41,"value":965},"(() ",{"type":28,"tag":130,"props":967,"children":968},{"style":153},[969],{"type":41,"value":970},"=>",{"type":28,"tag":130,"props":972,"children":973},{"style":143},[974],{"type":41,"value":610},{"type":28,"tag":130,"props":976,"children":977},{"style":159},[978],{"type":41,"value":615},{"type":28,"tag":130,"props":980,"children":981},{"style":143},[982],{"type":41,"value":983},"(message));\n",{"type":28,"tag":130,"props":985,"children":987},{"class":132,"line":986},26,[988,992,996,1000,1004,1008,1012,1016,1020,1024,1028],{"type":28,"tag":130,"props":989,"children":990},{"style":143},[991],{"type":41,"value":504},{"type":28,"tag":130,"props":993,"children":994},{"style":159},[995],{"type":41,"value":590},{"type":28,"tag":130,"props":997,"children":998},{"style":153},[999],{"type":41,"value":156},{"type":28,"tag":130,"props":1001,"children":1002},{"style":597},[1003],{"type":41,"value":600},{"type":28,"tag":130,"props":1005,"children":1006},{"style":153},[1007],{"type":41,"value":605},{"type":28,"tag":130,"props":1009,"children":1010},{"style":159},[1011],{"type":41,"value":960},{"type":28,"tag":130,"props":1013,"children":1014},{"style":143},[1015],{"type":41,"value":965},{"type":28,"tag":130,"props":1017,"children":1018},{"style":153},[1019],{"type":41,"value":970},{"type":28,"tag":130,"props":1021,"children":1022},{"style":143},[1023],{"type":41,"value":649},{"type":28,"tag":130,"props":1025,"children":1026},{"style":159},[1027],{"type":41,"value":615},{"type":28,"tag":130,"props":1029,"children":1030},{"style":143},[1031],{"type":41,"value":983},{"type":28,"tag":130,"props":1033,"children":1035},{"class":132,"line":1034},27,[1036],{"type":28,"tag":130,"props":1037,"children":1038},{"emptyLinePlaceholder":443},[1039],{"type":41,"value":446},{"type":28,"tag":130,"props":1041,"children":1043},{"class":132,"line":1042},28,[1044,1048,1053,1057,1062,1067,1071,1076,1080,1084],{"type":28,"tag":130,"props":1045,"children":1046},{"style":143},[1047],{"type":41,"value":504},{"type":28,"tag":130,"props":1049,"children":1050},{"style":159},[1051],{"type":41,"value":1052},"toImpl",{"type":28,"tag":130,"props":1054,"children":1055},{"style":153},[1056],{"type":41,"value":156},{"type":28,"tag":130,"props":1058,"children":1059},{"style":143},[1060],{"type":41,"value":1061}," (",{"type":28,"tag":130,"props":1063,"children":1064},{"style":597},[1065],{"type":41,"value":1066},"x",{"type":28,"tag":130,"props":1068,"children":1069},{"style":153},[1070],{"type":41,"value":340},{"type":28,"tag":130,"props":1072,"children":1073},{"style":137},[1074],{"type":41,"value":1075}," any",{"type":28,"tag":130,"props":1077,"children":1078},{"style":143},[1079],{"type":41,"value":417},{"type":28,"tag":130,"props":1081,"children":1082},{"style":153},[1083],{"type":41,"value":970},{"type":28,"tag":130,"props":1085,"children":1086},{"style":143},[1087],{"type":41,"value":1088}," x\n",{"type":28,"tag":130,"props":1090,"children":1092},{"class":132,"line":1091},29,[1093,1098,1103,1108,1113,1118],{"type":28,"tag":130,"props":1094,"children":1095},{"style":153},[1096],{"type":41,"value":1097},"    ?",{"type":28,"tag":130,"props":1099,"children":1100},{"style":143},[1101],{"type":41,"value":1102}," dispatcherConnection._dispatchers.",{"type":28,"tag":130,"props":1104,"children":1105},{"style":159},[1106],{"type":41,"value":1107},"get",{"type":28,"tag":130,"props":1109,"children":1110},{"style":143},[1111],{"type":41,"value":1112},"(x._guid)",{"type":28,"tag":130,"props":1114,"children":1115},{"style":153},[1116],{"type":41,"value":1117},"!",{"type":28,"tag":130,"props":1119,"children":1120},{"style":143},[1121],{"type":41,"value":1122},"._object\n",{"type":28,"tag":130,"props":1124,"children":1126},{"class":132,"line":1125},30,[1127,1132,1136,1140,1144,1149],{"type":28,"tag":130,"props":1128,"children":1129},{"style":153},[1130],{"type":41,"value":1131},"    :",{"type":28,"tag":130,"props":1133,"children":1134},{"style":143},[1135],{"type":41,"value":1102},{"type":28,"tag":130,"props":1137,"children":1138},{"style":159},[1139],{"type":41,"value":1107},{"type":28,"tag":130,"props":1141,"children":1142},{"style":143},[1143],{"type":41,"value":167},{"type":28,"tag":130,"props":1145,"children":1146},{"style":170},[1147],{"type":41,"value":1148},"''",{"type":28,"tag":130,"props":1150,"children":1151},{"style":143},[1152],{"type":41,"value":178},{"type":28,"tag":130,"props":1154,"children":1156},{"class":132,"line":1155},31,[1157,1162,1166,1170,1175,1179],{"type":28,"tag":130,"props":1158,"children":1159},{"style":143},[1160],{"type":41,"value":1161},"  (playwrightAPI ",{"type":28,"tag":130,"props":1163,"children":1164},{"style":153},[1165],{"type":41,"value":775},{"type":28,"tag":130,"props":1167,"children":1168},{"style":137},[1169],{"type":41,"value":1075},{"type":28,"tag":130,"props":1171,"children":1172},{"style":143},[1173],{"type":41,"value":1174},")._toImpl ",{"type":28,"tag":130,"props":1176,"children":1177},{"style":153},[1178],{"type":41,"value":798},{"type":28,"tag":130,"props":1180,"children":1181},{"style":143},[1182],{"type":41,"value":1183}," clientConnection.toImpl;\n",{"type":28,"tag":130,"props":1185,"children":1187},{"class":132,"line":1186},32,[1188,1193],{"type":28,"tag":130,"props":1189,"children":1190},{"style":153},[1191],{"type":41,"value":1192},"  return",{"type":28,"tag":130,"props":1194,"children":1195},{"style":143},[1196],{"type":41,"value":1197}," playwrightAPI;\n",{"type":28,"tag":130,"props":1199,"children":1201},{"class":132,"line":1200},33,[1202],{"type":28,"tag":130,"props":1203,"children":1204},{"style":143},[1205],{"type":41,"value":1206},"}\n",{"type":28,"tag":1208,"props":1209,"children":1211},"h3",{"id":1210},"cross-communication-between-client-and-server",[1212],{"type":41,"value":1213},"Cross communication between client and server",{"type":28,"tag":29,"props":1215,"children":1216},{},[1217,1219,1225,1227,1233,1235,1240,1242,1248,1249,1255,1257,1262,1264,1269],{"type":41,"value":1218},"If you scan through the script, noting the imports for anything with ",{"type":28,"tag":44,"props":1220,"children":1222},{"className":1221},[],[1223],{"type":41,"value":1224},"Dispatcher",{"type":41,"value":1226}," in its name, and ",{"type":28,"tag":44,"props":1228,"children":1230},{"className":1229},[],[1231],{"type":41,"value":1232},"createPlaywright",{"type":41,"value":1234},", comes from the ",{"type":28,"tag":44,"props":1236,"children":1238},{"className":1237},[],[1239],{"type":41,"value":244},{"type":41,"value":1241}," directory, but the imports for ",{"type":28,"tag":44,"props":1243,"children":1245},{"className":1244},[],[1246],{"type":41,"value":1247},"Connection",{"type":41,"value":59},{"type":28,"tag":44,"props":1250,"children":1252},{"className":1251},[],[1253],{"type":41,"value":1254},"PlaywrightAPI",{"type":41,"value":1256}," come from the ",{"type":28,"tag":44,"props":1258,"children":1260},{"className":1259},[],[1261],{"type":41,"value":236},{"type":41,"value":1263}," directory, you'll find there's cross-communication between these two packages. The interface between these two parts of the core library is through the ",{"type":28,"tag":44,"props":1265,"children":1267},{"className":1266},[],[1268],{"type":41,"value":590},{"type":41,"value":1270}," property for each connection, set as",{"type":28,"tag":119,"props":1272,"children":1274},{"className":305,"code":1273,"filename":307,"language":308,"meta":7,"style":7},"dispatcherConnection.onmessage = message => clientConnection.dispatch(message);\nclientConnection.onmessage = message => dispatcherConnection.dispatch(message);\n",[1275],{"type":28,"tag":44,"props":1276,"children":1277},{"__ignoreMap":7},[1278,1314],{"type":28,"tag":130,"props":1279,"children":1280},{"class":132,"line":133},[1281,1286,1290,1294,1298,1302,1306,1310],{"type":28,"tag":130,"props":1282,"children":1283},{"style":143},[1284],{"type":41,"value":1285},"dispatcherConnection.",{"type":28,"tag":130,"props":1287,"children":1288},{"style":159},[1289],{"type":41,"value":590},{"type":28,"tag":130,"props":1291,"children":1292},{"style":153},[1293],{"type":41,"value":156},{"type":28,"tag":130,"props":1295,"children":1296},{"style":597},[1297],{"type":41,"value":600},{"type":28,"tag":130,"props":1299,"children":1300},{"style":153},[1301],{"type":41,"value":605},{"type":28,"tag":130,"props":1303,"children":1304},{"style":143},[1305],{"type":41,"value":610},{"type":28,"tag":130,"props":1307,"children":1308},{"style":159},[1309],{"type":41,"value":615},{"type":28,"tag":130,"props":1311,"children":1312},{"style":143},[1313],{"type":41,"value":620},{"type":28,"tag":130,"props":1315,"children":1316},{"class":132,"line":353},[1317,1322,1326,1330,1334,1338,1342,1346],{"type":28,"tag":130,"props":1318,"children":1319},{"style":143},[1320],{"type":41,"value":1321},"clientConnection.",{"type":28,"tag":130,"props":1323,"children":1324},{"style":159},[1325],{"type":41,"value":590},{"type":28,"tag":130,"props":1327,"children":1328},{"style":153},[1329],{"type":41,"value":156},{"type":28,"tag":130,"props":1331,"children":1332},{"style":597},[1333],{"type":41,"value":600},{"type":28,"tag":130,"props":1335,"children":1336},{"style":153},[1337],{"type":41,"value":605},{"type":28,"tag":130,"props":1339,"children":1340},{"style":143},[1341],{"type":41,"value":649},{"type":28,"tag":130,"props":1343,"children":1344},{"style":159},[1345],{"type":41,"value":615},{"type":28,"tag":130,"props":1347,"children":1348},{"style":143},[1349],{"type":41,"value":620},{"type":28,"tag":29,"props":1351,"children":1352},{},[1353,1355,1360,1362,1368],{"type":41,"value":1354},"Also, the ",{"type":28,"tag":44,"props":1356,"children":1358},{"className":1357},[],[1359],{"type":41,"value":1254},{"type":41,"value":1361}," instance is creating dynamically from the ",{"type":28,"tag":44,"props":1363,"children":1365},{"className":1364},[],[1366],{"type":41,"value":1367},"clientConection",{"type":41,"value":397},{"type":28,"tag":119,"props":1370,"children":1372},{"className":305,"code":1371,"filename":307,"language":308,"meta":7,"style":7},"const playwrightAPI = clientConnection.getObjectWithKnownName('Playwright') as PlaywrightAPI;\n",[1373],{"type":28,"tag":44,"props":1374,"children":1375},{"__ignoreMap":7},[1376],{"type":28,"tag":130,"props":1377,"children":1378},{"class":132,"line":133},[1379,1384,1388,1392,1396,1400,1404,1408,1412,1416,1420],{"type":28,"tag":130,"props":1380,"children":1381},{"style":153},[1382],{"type":41,"value":1383},"const",{"type":28,"tag":130,"props":1385,"children":1386},{"style":137},[1387],{"type":41,"value":744},{"type":28,"tag":130,"props":1389,"children":1390},{"style":153},[1391],{"type":41,"value":156},{"type":28,"tag":130,"props":1393,"children":1394},{"style":143},[1395],{"type":41,"value":610},{"type":28,"tag":130,"props":1397,"children":1398},{"style":159},[1399],{"type":41,"value":757},{"type":28,"tag":130,"props":1401,"children":1402},{"style":143},[1403],{"type":41,"value":167},{"type":28,"tag":130,"props":1405,"children":1406},{"style":170},[1407],{"type":41,"value":766},{"type":28,"tag":130,"props":1409,"children":1410},{"style":143},[1411],{"type":41,"value":417},{"type":28,"tag":130,"props":1413,"children":1414},{"style":153},[1415],{"type":41,"value":775},{"type":28,"tag":130,"props":1417,"children":1418},{"style":159},[1419],{"type":41,"value":345},{"type":28,"tag":130,"props":1421,"children":1422},{"style":143},[1423],{"type":41,"value":784},{"type":28,"tag":29,"props":1425,"children":1426},{},[1427],{"type":41,"value":1428},"which is the client API you will use if importing a browser, e.g.",{"type":28,"tag":119,"props":1430,"children":1433},{"className":305,"code":1431,"filename":1432,"language":308,"meta":7,"style":7},"import { chromium } from 'playwright-core'\n","my-automation-script.ts",[1434],{"type":28,"tag":44,"props":1435,"children":1436},{"__ignoreMap":7},[1437],{"type":28,"tag":130,"props":1438,"children":1439},{"class":132,"line":133},[1440,1445,1450,1455],{"type":28,"tag":130,"props":1441,"children":1442},{"style":153},[1443],{"type":41,"value":1444},"import",{"type":28,"tag":130,"props":1446,"children":1447},{"style":143},[1448],{"type":41,"value":1449}," { chromium } ",{"type":28,"tag":130,"props":1451,"children":1452},{"style":153},[1453],{"type":41,"value":1454},"from",{"type":28,"tag":130,"props":1456,"children":1457},{"style":170},[1458],{"type":41,"value":1459}," 'playwright-core'\n",{"type":28,"tag":29,"props":1461,"children":1462},{},[1463,1465,1471,1473,1478,1480,1486],{"type":41,"value":1464},"so on first site is not clear what kind of code execution is actually happening here since you might expect to just be importing from the ",{"type":28,"tag":44,"props":1466,"children":1468},{"className":1467},[],[1469],{"type":41,"value":1470},"client",{"type":41,"value":1472}," library in ",{"type":28,"tag":44,"props":1474,"children":1476},{"className":1475},[],[1477],{"type":41,"value":107},{"type":41,"value":1479},". This mystery is answered by tracing the logic of the two lines of code between the onmessage variables being set, and the creation of the ",{"type":28,"tag":44,"props":1481,"children":1483},{"className":1482},[],[1484],{"type":41,"value":1485},"playwrightAPI",{"type":41,"value":340},{"type":28,"tag":119,"props":1488,"children":1490},{"className":305,"code":1489,"filename":307,"language":308,"meta":7,"style":7},"const rootScope = new RootDispatcher(dispatcherConnection);\n\n// Initialize Playwright channel.\nnew PlaywrightDispatcher(rootScope, playwright);\n",[1491],{"type":28,"tag":44,"props":1492,"children":1493},{"__ignoreMap":7},[1494,1521,1528,1536],{"type":28,"tag":130,"props":1495,"children":1496},{"class":132,"line":133},[1497,1501,1505,1509,1513,1517],{"type":28,"tag":130,"props":1498,"children":1499},{"style":153},[1500],{"type":41,"value":1383},{"type":28,"tag":130,"props":1502,"children":1503},{"style":137},[1504],{"type":41,"value":677},{"type":28,"tag":130,"props":1506,"children":1507},{"style":153},[1508],{"type":41,"value":156},{"type":28,"tag":130,"props":1510,"children":1511},{"style":153},[1512],{"type":41,"value":468},{"type":28,"tag":130,"props":1514,"children":1515},{"style":159},[1516],{"type":41,"value":690},{"type":28,"tag":130,"props":1518,"children":1519},{"style":143},[1520],{"type":41,"value":695},{"type":28,"tag":130,"props":1522,"children":1523},{"class":132,"line":353},[1524],{"type":28,"tag":130,"props":1525,"children":1526},{"emptyLinePlaceholder":443},[1527],{"type":41,"value":446},{"type":28,"tag":130,"props":1529,"children":1530},{"class":132,"line":381},[1531],{"type":28,"tag":130,"props":1532,"children":1533},{"style":552},[1534],{"type":41,"value":1535},"// Initialize Playwright channel.\n",{"type":28,"tag":130,"props":1537,"children":1538},{"class":132,"line":430},[1539,1544,1548],{"type":28,"tag":130,"props":1540,"children":1541},{"style":153},[1542],{"type":41,"value":1543},"new",{"type":28,"tag":130,"props":1545,"children":1546},{"style":159},[1547],{"type":41,"value":726},{"type":28,"tag":130,"props":1549,"children":1550},{"style":143},[1551],{"type":41,"value":731},{"type":28,"tag":29,"props":1553,"children":1554},{},[1555,1557,1563,1565,1571,1573,1579,1581,1587],{"type":41,"value":1556},"Here the rootScope acts as a wrapper around the dispatcherConnection which every subsequent dispatcher uses under the hood. This is because the ",{"type":28,"tag":44,"props":1558,"children":1560},{"className":1559},[],[1561],{"type":41,"value":1562},"PlaywrightDispatcher",{"type":41,"value":1564}," passes in the ",{"type":28,"tag":44,"props":1566,"children":1568},{"className":1567},[],[1569],{"type":41,"value":1570},"rootScope",{"type":41,"value":1572}," as ",{"type":28,"tag":44,"props":1574,"children":1576},{"className":1575},[],[1577],{"type":41,"value":1578},"scope",{"type":41,"value":1580}," in its constructor when calling ",{"type":28,"tag":44,"props":1582,"children":1584},{"className":1583},[],[1585],{"type":41,"value":1586},"super",{"type":41,"value":1588},". Here I include a simplified version of the constructor:",{"type":28,"tag":119,"props":1590,"children":1593},{"className":305,"code":1591,"filename":1592,"language":308,"meta":7,"style":7},"constructor(scope: RootDispatcher, playwright: Playwright) {\n  const android = new AndroidDispatcher(scope, playwright.android);\n  // parameter names in the base Dispatcher class are\n  // parent, object, type, initializer\n  super(scope, playwright, 'Playwright', {\n    chromium: new BrowserTypeDispatcher(scope, playwright.chromium),\n    firefox: new BrowserTypeDispatcher(scope, playwright.firefox),\n    webkit: new BrowserTypeDispatcher(scope, playwright.webkit),\n    android,\n    electron: new ElectronDispatcher(scope, playwright.electron),\n  });\n}\n","packages/playwright-core/src/server/dispatchers/playwrightDispatcher.ts",[1594],{"type":28,"tag":44,"props":1595,"children":1596},{"__ignoreMap":7},[1597,1610,1640,1648,1656,1678,1700,1721,1742,1750,1772,1779],{"type":28,"tag":130,"props":1598,"children":1599},{"class":132,"line":133},[1600,1605],{"type":28,"tag":130,"props":1601,"children":1602},{"style":159},[1603],{"type":41,"value":1604},"constructor",{"type":28,"tag":130,"props":1606,"children":1607},{"style":143},[1608],{"type":41,"value":1609},"(scope: RootDispatcher, playwright: Playwright) {\n",{"type":28,"tag":130,"props":1611,"children":1612},{"class":132,"line":353},[1613,1617,1622,1626,1630,1635],{"type":28,"tag":130,"props":1614,"children":1615},{"style":153},[1616],{"type":41,"value":359},{"type":28,"tag":130,"props":1618,"children":1619},{"style":137},[1620],{"type":41,"value":1621}," android",{"type":28,"tag":130,"props":1623,"children":1624},{"style":153},[1625],{"type":41,"value":156},{"type":28,"tag":130,"props":1627,"children":1628},{"style":153},[1629],{"type":41,"value":468},{"type":28,"tag":130,"props":1631,"children":1632},{"style":159},[1633],{"type":41,"value":1634}," AndroidDispatcher",{"type":28,"tag":130,"props":1636,"children":1637},{"style":143},[1638],{"type":41,"value":1639},"(scope, playwright.android);\n",{"type":28,"tag":130,"props":1641,"children":1642},{"class":132,"line":381},[1643],{"type":28,"tag":130,"props":1644,"children":1645},{"style":552},[1646],{"type":41,"value":1647},"  // parameter names in the base Dispatcher class are\n",{"type":28,"tag":130,"props":1649,"children":1650},{"class":132,"line":430},[1651],{"type":28,"tag":130,"props":1652,"children":1653},{"style":552},[1654],{"type":41,"value":1655},"  // parent, object, type, initializer\n",{"type":28,"tag":130,"props":1657,"children":1658},{"class":132,"line":439},[1659,1664,1669,1673],{"type":28,"tag":130,"props":1660,"children":1661},{"style":137},[1662],{"type":41,"value":1663},"  super",{"type":28,"tag":130,"props":1665,"children":1666},{"style":143},[1667],{"type":41,"value":1668},"(scope, playwright, ",{"type":28,"tag":130,"props":1670,"children":1671},{"style":170},[1672],{"type":41,"value":766},{"type":28,"tag":130,"props":1674,"children":1675},{"style":143},[1676],{"type":41,"value":1677},", {\n",{"type":28,"tag":130,"props":1679,"children":1680},{"class":132,"line":449},[1681,1686,1690,1695],{"type":28,"tag":130,"props":1682,"children":1683},{"style":143},[1684],{"type":41,"value":1685},"    chromium: ",{"type":28,"tag":130,"props":1687,"children":1688},{"style":153},[1689],{"type":41,"value":1543},{"type":28,"tag":130,"props":1691,"children":1692},{"style":159},[1693],{"type":41,"value":1694}," BrowserTypeDispatcher",{"type":28,"tag":130,"props":1696,"children":1697},{"style":143},[1698],{"type":41,"value":1699},"(scope, playwright.chromium),\n",{"type":28,"tag":130,"props":1701,"children":1702},{"class":132,"line":498},[1703,1708,1712,1716],{"type":28,"tag":130,"props":1704,"children":1705},{"style":143},[1706],{"type":41,"value":1707},"    firefox: ",{"type":28,"tag":130,"props":1709,"children":1710},{"style":153},[1711],{"type":41,"value":1543},{"type":28,"tag":130,"props":1713,"children":1714},{"style":159},[1715],{"type":41,"value":1694},{"type":28,"tag":130,"props":1717,"children":1718},{"style":143},[1719],{"type":41,"value":1720},"(scope, playwright.firefox),\n",{"type":28,"tag":130,"props":1722,"children":1723},{"class":132,"line":517},[1724,1729,1733,1737],{"type":28,"tag":130,"props":1725,"children":1726},{"style":143},[1727],{"type":41,"value":1728},"    webkit: ",{"type":28,"tag":130,"props":1730,"children":1731},{"style":153},[1732],{"type":41,"value":1543},{"type":28,"tag":130,"props":1734,"children":1735},{"style":159},[1736],{"type":41,"value":1694},{"type":28,"tag":130,"props":1738,"children":1739},{"style":143},[1740],{"type":41,"value":1741},"(scope, playwright.webkit),\n",{"type":28,"tag":130,"props":1743,"children":1744},{"class":132,"line":562},[1745],{"type":28,"tag":130,"props":1746,"children":1747},{"style":143},[1748],{"type":41,"value":1749},"    android,\n",{"type":28,"tag":130,"props":1751,"children":1752},{"class":132,"line":570},[1753,1758,1762,1767],{"type":28,"tag":130,"props":1754,"children":1755},{"style":143},[1756],{"type":41,"value":1757},"    electron: ",{"type":28,"tag":130,"props":1759,"children":1760},{"style":153},[1761],{"type":41,"value":1543},{"type":28,"tag":130,"props":1763,"children":1764},{"style":159},[1765],{"type":41,"value":1766}," ElectronDispatcher",{"type":28,"tag":130,"props":1768,"children":1769},{"style":143},[1770],{"type":41,"value":1771},"(scope, playwright.electron),\n",{"type":28,"tag":130,"props":1773,"children":1774},{"class":132,"line":579},[1775],{"type":28,"tag":130,"props":1776,"children":1777},{"style":143},[1778],{"type":41,"value":436},{"type":28,"tag":130,"props":1780,"children":1781},{"class":132,"line":623},[1782],{"type":28,"tag":130,"props":1783,"children":1784},{"style":143},[1785],{"type":41,"value":1206},{"type":28,"tag":29,"props":1787,"children":1788},{},[1789,1791,1796,1798,1803,1805,1810,1812,1818,1820,1826,1828,1834,1836,1842,1844,1850],{"type":41,"value":1790},"Notice the ",{"type":28,"tag":44,"props":1792,"children":1794},{"className":1793},[],[1795],{"type":41,"value":1586},{"type":41,"value":1797}," call has parameters for each of the driver types (chromium, firefox, etc.), in its initializers object. And each of the values have the scope the ",{"type":28,"tag":44,"props":1799,"children":1801},{"className":1800},[],[1802],{"type":41,"value":1570},{"type":41,"value":1804},". Every call to the server will run through the connection in the ",{"type":28,"tag":44,"props":1806,"children":1808},{"className":1807},[],[1809],{"type":41,"value":1570},{"type":41,"value":1811},", which then can be traced through calls in each of the dispatcher classes. For example, ",{"type":28,"tag":44,"props":1813,"children":1815},{"className":1814},[],[1816],{"type":41,"value":1817},"BrowserTypeDispatcher",{"type":41,"value":1819}," will launch a ",{"type":28,"tag":44,"props":1821,"children":1823},{"className":1822},[],[1824],{"type":41,"value":1825},"BrowserDispatcher",{"type":41,"value":1827},", which is responsible for creating a ",{"type":28,"tag":44,"props":1829,"children":1831},{"className":1830},[],[1832],{"type":41,"value":1833},"BrowserContextDispatcher",{"type":41,"value":1835},", which can create a ",{"type":28,"tag":44,"props":1837,"children":1839},{"className":1838},[],[1840],{"type":41,"value":1841},"PageDispatcher",{"type":41,"value":1843},", etc. The whole hierarchy of dispatchers directly interacting with the automated browser is contained within these few dispatcher initializations. So now we can trace all calls back to the original ",{"type":28,"tag":44,"props":1845,"children":1847},{"className":1846},[],[1848],{"type":41,"value":1849},"dispatcherConnection",{"type":41,"value":1851}," defined in the factory method with confidence!",{"type":28,"tag":29,"props":1853,"children":1854},{},[1855,1857,1862,1864,1869,1871,1876,1877,1883,1885,1891,1893,1898,1900,1906,1908,1913,1915,1921,1923,1928,1930,1936,1937,1943,1944,1950,1952,1958,1960,1965,1967,1973],{"type":41,"value":1856},"The other important bit to note is where ",{"type":28,"tag":44,"props":1858,"children":1860},{"className":1859},[],[1861],{"type":41,"value":590},{"type":41,"value":1863}," is called within the ",{"type":28,"tag":44,"props":1865,"children":1867},{"className":1866},[],[1868],{"type":41,"value":1849},{"type":41,"value":1870},". The two main wrappers around this method are ",{"type":28,"tag":44,"props":1872,"children":1874},{"className":1873},[],[1875],{"type":41,"value":615},{"type":41,"value":59},{"type":28,"tag":44,"props":1878,"children":1880},{"className":1879},[],[1881],{"type":41,"value":1882},"_sendMessageToClient",{"type":41,"value":1884}," in ",{"type":28,"tag":44,"props":1886,"children":1888},{"className":1887},[],[1889],{"type":41,"value":1890},"DispatcherConnection",{"type":41,"value":1892},". The ",{"type":28,"tag":44,"props":1894,"children":1896},{"className":1895},[],[1897],{"type":41,"value":615},{"type":41,"value":1899}," function is called on the client side, from the ",{"type":28,"tag":44,"props":1901,"children":1903},{"className":1902},[],[1904],{"type":41,"value":1905},"clientConnection.onmessage",{"type":41,"value":1907}," function, so you can interpret this as the main interface the client interacts with the server, where the dispatcher finds the corresponding dispatcher, calls the action, and responds back to the listener connected via ",{"type":28,"tag":44,"props":1909,"children":1911},{"className":1910},[],[1912],{"type":41,"value":590},{"type":41,"value":1914},", which here is the ",{"type":28,"tag":44,"props":1916,"children":1918},{"className":1917},[],[1919],{"type":41,"value":1920},"clientConnection",{"type":41,"value":1922},". The other wrapper, ",{"type":28,"tag":44,"props":1924,"children":1926},{"className":1925},[],[1927],{"type":41,"value":1882},{"type":41,"value":1929},", is called from the ",{"type":28,"tag":44,"props":1931,"children":1933},{"className":1932},[],[1934],{"type":41,"value":1935},"sendEvent",{"type":41,"value":487},{"type":28,"tag":44,"props":1938,"children":1940},{"className":1939},[],[1941],{"type":41,"value":1942},"sendCreate",{"type":41,"value":487},{"type":28,"tag":44,"props":1945,"children":1947},{"className":1946},[],[1948],{"type":41,"value":1949},"sendAdopt",{"type":41,"value":1951},", and ",{"type":28,"tag":44,"props":1953,"children":1955},{"className":1954},[],[1956],{"type":41,"value":1957},"sendDestroy",{"type":41,"value":1959}," methods defined within the dispatcher. Calls to these functions are spread throughout the ",{"type":28,"tag":44,"props":1961,"children":1963},{"className":1962},[],[1964],{"type":41,"value":1224},{"type":41,"value":1966}," subclasses, which call these functions from their internal ",{"type":28,"tag":44,"props":1968,"children":1970},{"className":1969},[],[1971],{"type":41,"value":1972},"_connection",{"type":41,"value":1974}," variable.",{"type":28,"tag":29,"props":1976,"children":1977},{},[1978,1980,1985,1987,1992,1994,1999,2001,2006,2008,2014],{"type":41,"value":1979},"The ",{"type":28,"tag":44,"props":1981,"children":1983},{"className":1982},[],[1984],{"type":41,"value":1942},{"type":41,"value":1986}," function is special because it is only called from within the ",{"type":28,"tag":44,"props":1988,"children":1990},{"className":1989},[],[1991],{"type":41,"value":1224},{"type":41,"value":1993}," constructor, hence the constructor of every subclass. This tells the client connection to create a corresponding client-side class which handles messaging to this dispatcher. Moreover, looking into the ",{"type":28,"tag":44,"props":1995,"children":1997},{"className":1996},[],[1998],{"type":41,"value":1942},{"type":41,"value":2000}," implementation, internally it calls ",{"type":28,"tag":44,"props":2002,"children":2004},{"className":2003},[],[2005],{"type":41,"value":1882},{"type":41,"value":2007}," with the ",{"type":28,"tag":44,"props":2009,"children":2011},{"className":2010},[],[2012],{"type":41,"value":2013},"__create__",{"type":41,"value":2015}," parameter:",{"type":28,"tag":119,"props":2017,"children":2020},{"className":305,"code":2018,"filename":2019,"language":308,"meta":7,"style":7},"sendCreate(parent: DispatcherScope, type: string, guid: string, initializer: any, sdkObject?: SdkObject) {\n  const validator = findValidator(type, '', 'Initializer');\n  initializer = validator(initializer, '', { tChannelImpl: this._tChannelImplToWire.bind(this), binary: this._isLocal ? 'buffer' : 'toBase64' });\n  this._sendMessageToClient(parent._guid, type, '__create__', { type, initializer, guid }, sdkObject);\n}\n","packages/playwright-core/src/server/dispatchers/dispatcher.ts",[2021],{"type":28,"tag":44,"props":2022,"children":2023},{"__ignoreMap":7},[2024,2046,2089,2181,2212],{"type":28,"tag":130,"props":2025,"children":2026},{"class":132,"line":133},[2027,2031,2036,2041],{"type":28,"tag":130,"props":2028,"children":2029},{"style":159},[2030],{"type":41,"value":1942},{"type":28,"tag":130,"props":2032,"children":2033},{"style":143},[2034],{"type":41,"value":2035},"(parent: DispatcherScope, type: string, guid: string, initializer: any, sdkObject",{"type":28,"tag":130,"props":2037,"children":2038},{"style":153},[2039],{"type":41,"value":2040},"?:",{"type":28,"tag":130,"props":2042,"children":2043},{"style":143},[2044],{"type":41,"value":2045}," SdkObject) {\n",{"type":28,"tag":130,"props":2047,"children":2048},{"class":132,"line":353},[2049,2053,2058,2062,2067,2072,2076,2080,2085],{"type":28,"tag":130,"props":2050,"children":2051},{"style":153},[2052],{"type":41,"value":359},{"type":28,"tag":130,"props":2054,"children":2055},{"style":137},[2056],{"type":41,"value":2057}," validator",{"type":28,"tag":130,"props":2059,"children":2060},{"style":153},[2061],{"type":41,"value":156},{"type":28,"tag":130,"props":2063,"children":2064},{"style":159},[2065],{"type":41,"value":2066}," findValidator",{"type":28,"tag":130,"props":2068,"children":2069},{"style":143},[2070],{"type":41,"value":2071},"(type, ",{"type":28,"tag":130,"props":2073,"children":2074},{"style":170},[2075],{"type":41,"value":1148},{"type":28,"tag":130,"props":2077,"children":2078},{"style":143},[2079],{"type":41,"value":487},{"type":28,"tag":130,"props":2081,"children":2082},{"style":170},[2083],{"type":41,"value":2084},"'Initializer'",{"type":28,"tag":130,"props":2086,"children":2087},{"style":143},[2088],{"type":41,"value":178},{"type":28,"tag":130,"props":2090,"children":2091},{"class":132,"line":381},[2092,2097,2101,2105,2110,2114,2119,2124,2129,2134,2138,2142,2147,2151,2156,2161,2166,2171,2176],{"type":28,"tag":130,"props":2093,"children":2094},{"style":143},[2095],{"type":41,"value":2096},"  initializer ",{"type":28,"tag":130,"props":2098,"children":2099},{"style":153},[2100],{"type":41,"value":798},{"type":28,"tag":130,"props":2102,"children":2103},{"style":159},[2104],{"type":41,"value":2057},{"type":28,"tag":130,"props":2106,"children":2107},{"style":143},[2108],{"type":41,"value":2109},"(initializer, ",{"type":28,"tag":130,"props":2111,"children":2112},{"style":170},[2113],{"type":41,"value":1148},{"type":28,"tag":130,"props":2115,"children":2116},{"style":143},[2117],{"type":41,"value":2118},", { tChannelImpl: ",{"type":28,"tag":130,"props":2120,"children":2121},{"style":137},[2122],{"type":41,"value":2123},"this",{"type":28,"tag":130,"props":2125,"children":2126},{"style":143},[2127],{"type":41,"value":2128},"._tChannelImplToWire.",{"type":28,"tag":130,"props":2130,"children":2131},{"style":159},[2132],{"type":41,"value":2133},"bind",{"type":28,"tag":130,"props":2135,"children":2136},{"style":143},[2137],{"type":41,"value":167},{"type":28,"tag":130,"props":2139,"children":2140},{"style":137},[2141],{"type":41,"value":2123},{"type":28,"tag":130,"props":2143,"children":2144},{"style":143},[2145],{"type":41,"value":2146},"), binary: ",{"type":28,"tag":130,"props":2148,"children":2149},{"style":137},[2150],{"type":41,"value":2123},{"type":28,"tag":130,"props":2152,"children":2153},{"style":143},[2154],{"type":41,"value":2155},"._isLocal ",{"type":28,"tag":130,"props":2157,"children":2158},{"style":153},[2159],{"type":41,"value":2160},"?",{"type":28,"tag":130,"props":2162,"children":2163},{"style":170},[2164],{"type":41,"value":2165}," 'buffer'",{"type":28,"tag":130,"props":2167,"children":2168},{"style":153},[2169],{"type":41,"value":2170}," :",{"type":28,"tag":130,"props":2172,"children":2173},{"style":170},[2174],{"type":41,"value":2175}," 'toBase64'",{"type":28,"tag":130,"props":2177,"children":2178},{"style":143},[2179],{"type":41,"value":2180}," });\n",{"type":28,"tag":130,"props":2182,"children":2183},{"class":132,"line":430},[2184,2189,2193,2197,2202,2207],{"type":28,"tag":130,"props":2185,"children":2186},{"style":137},[2187],{"type":41,"value":2188},"  this",{"type":28,"tag":130,"props":2190,"children":2191},{"style":143},[2192],{"type":41,"value":96},{"type":28,"tag":130,"props":2194,"children":2195},{"style":159},[2196],{"type":41,"value":1882},{"type":28,"tag":130,"props":2198,"children":2199},{"style":143},[2200],{"type":41,"value":2201},"(parent._guid, type, ",{"type":28,"tag":130,"props":2203,"children":2204},{"style":170},[2205],{"type":41,"value":2206},"'__create__'",{"type":28,"tag":130,"props":2208,"children":2209},{"style":143},[2210],{"type":41,"value":2211},", { type, initializer, guid }, sdkObject);\n",{"type":28,"tag":130,"props":2213,"children":2214},{"class":132,"line":439},[2215],{"type":28,"tag":130,"props":2216,"children":2217},{"style":143},[2218],{"type":41,"value":1206},{"type":28,"tag":29,"props":2220,"children":2221},{},[2222,2224,2229,2231,2236,2238,2244,2246,2251,2253,2258,2260,2265],{"type":41,"value":2223},"so if we search through the ",{"type":28,"tag":44,"props":2225,"children":2227},{"className":2226},[],[2228],{"type":41,"value":1247},{"type":41,"value":2230}," class on the client side, sure enough in its ",{"type":28,"tag":44,"props":2232,"children":2234},{"className":2233},[],[2235],{"type":41,"value":615},{"type":41,"value":2237}," function it has a call to ",{"type":28,"tag":44,"props":2239,"children":2241},{"className":2240},[],[2242],{"type":41,"value":2243},"_createRemoteObject",{"type":41,"value":2245}," for the associated method ",{"type":28,"tag":44,"props":2247,"children":2249},{"className":2248},[],[2250],{"type":41,"value":2013},{"type":41,"value":2252},". This ",{"type":28,"tag":44,"props":2254,"children":2256},{"className":2255},[],[2257],{"type":41,"value":2243},{"type":41,"value":2259}," is what initializes the client-side ",{"type":28,"tag":44,"props":2261,"children":2263},{"className":2262},[],[2264],{"type":41,"value":12},{"type":41,"value":2266}," instance, and is why we call",{"type":28,"tag":119,"props":2268,"children":2270},{"className":305,"code":2269,"language":308,"meta":7,"style":7},"const playwrightAPI = clientConnection.getObjectWithKnownName('Playwright');\n",[2271],{"type":28,"tag":44,"props":2272,"children":2273},{"__ignoreMap":7},[2274],{"type":28,"tag":130,"props":2275,"children":2276},{"class":132,"line":133},[2277,2281,2285,2289,2293,2297,2301,2305],{"type":28,"tag":130,"props":2278,"children":2279},{"style":153},[2280],{"type":41,"value":1383},{"type":28,"tag":130,"props":2282,"children":2283},{"style":137},[2284],{"type":41,"value":744},{"type":28,"tag":130,"props":2286,"children":2287},{"style":153},[2288],{"type":41,"value":156},{"type":28,"tag":130,"props":2290,"children":2291},{"style":143},[2292],{"type":41,"value":610},{"type":28,"tag":130,"props":2294,"children":2295},{"style":159},[2296],{"type":41,"value":757},{"type":28,"tag":130,"props":2298,"children":2299},{"style":143},[2300],{"type":41,"value":167},{"type":28,"tag":130,"props":2302,"children":2303},{"style":170},[2304],{"type":41,"value":766},{"type":28,"tag":130,"props":2306,"children":2307},{"style":143},[2308],{"type":41,"value":178},{"type":28,"tag":29,"props":2310,"children":2311},{},[2312,2314,2319,2321,2326],{"type":41,"value":2313},"to set the playwright API. But let's dive a little deeper as to what's happening with the message from the ",{"type":28,"tag":44,"props":2315,"children":2317},{"className":2316},[],[2318],{"type":41,"value":1849},{"type":41,"value":2320}," over to the ",{"type":28,"tag":44,"props":2322,"children":2324},{"className":2323},[],[2325],{"type":41,"value":1920},{"type":41,"value":2327},". For the Playwright create message, it looks like",{"type":28,"tag":119,"props":2329,"children":2331},{"className":305,"code":2330,"language":308,"meta":7,"style":7},"{\n  guid: '',\n  method: '__create__',\n  params: {\n    type: 'Playwright',\n    initializer: {\n      chromium: { guid: 'browser-type@024d5a494527ece580841844a9a933a6' },\n      firefox: { guid: 'browser-type@fae8f48651c02682ad3b276f0a046d63' },\n      webkit: { guid: 'browser-type@ed1c30ab794ec863fe5b9b208c3635e1' },\n      android: { guid: 'android@832582c466c24c6933d3a5587059e1be' },\n      electron: { guid: 'electron@3829a7608477101154e15c1e25bca9ca' },\n    },\n    guid: 'Playwright'\n  }\n}\n",[2332],{"type":28,"tag":44,"props":2333,"children":2334},{"__ignoreMap":7},[2335,2343,2365,2385,2398,2418,2430,2462,2491,2520,2549,2578,2586,2603,2611],{"type":28,"tag":130,"props":2336,"children":2337},{"class":132,"line":133},[2338],{"type":28,"tag":130,"props":2339,"children":2340},{"style":143},[2341],{"type":41,"value":2342},"{\n",{"type":28,"tag":130,"props":2344,"children":2345},{"class":132,"line":353},[2346,2351,2356,2360],{"type":28,"tag":130,"props":2347,"children":2348},{"style":159},[2349],{"type":41,"value":2350},"  guid",{"type":28,"tag":130,"props":2352,"children":2353},{"style":143},[2354],{"type":41,"value":2355},": ",{"type":28,"tag":130,"props":2357,"children":2358},{"style":170},[2359],{"type":41,"value":1148},{"type":28,"tag":130,"props":2361,"children":2362},{"style":143},[2363],{"type":41,"value":2364},",\n",{"type":28,"tag":130,"props":2366,"children":2367},{"class":132,"line":381},[2368,2373,2377,2381],{"type":28,"tag":130,"props":2369,"children":2370},{"style":159},[2371],{"type":41,"value":2372},"  method",{"type":28,"tag":130,"props":2374,"children":2375},{"style":143},[2376],{"type":41,"value":2355},{"type":28,"tag":130,"props":2378,"children":2379},{"style":170},[2380],{"type":41,"value":2206},{"type":28,"tag":130,"props":2382,"children":2383},{"style":143},[2384],{"type":41,"value":2364},{"type":28,"tag":130,"props":2386,"children":2387},{"class":132,"line":430},[2388,2393],{"type":28,"tag":130,"props":2389,"children":2390},{"style":159},[2391],{"type":41,"value":2392},"  params",{"type":28,"tag":130,"props":2394,"children":2395},{"style":143},[2396],{"type":41,"value":2397},": {\n",{"type":28,"tag":130,"props":2399,"children":2400},{"class":132,"line":439},[2401,2406,2410,2414],{"type":28,"tag":130,"props":2402,"children":2403},{"style":159},[2404],{"type":41,"value":2405},"    type",{"type":28,"tag":130,"props":2407,"children":2408},{"style":143},[2409],{"type":41,"value":2355},{"type":28,"tag":130,"props":2411,"children":2412},{"style":170},[2413],{"type":41,"value":766},{"type":28,"tag":130,"props":2415,"children":2416},{"style":143},[2417],{"type":41,"value":2364},{"type":28,"tag":130,"props":2419,"children":2420},{"class":132,"line":449},[2421,2426],{"type":28,"tag":130,"props":2422,"children":2423},{"style":159},[2424],{"type":41,"value":2425},"    initializer",{"type":28,"tag":130,"props":2427,"children":2428},{"style":143},[2429],{"type":41,"value":2397},{"type":28,"tag":130,"props":2431,"children":2432},{"class":132,"line":498},[2433,2438,2443,2448,2452,2457],{"type":28,"tag":130,"props":2434,"children":2435},{"style":159},[2436],{"type":41,"value":2437},"      chromium",{"type":28,"tag":130,"props":2439,"children":2440},{"style":143},[2441],{"type":41,"value":2442},": { ",{"type":28,"tag":130,"props":2444,"children":2445},{"style":159},[2446],{"type":41,"value":2447},"guid",{"type":28,"tag":130,"props":2449,"children":2450},{"style":143},[2451],{"type":41,"value":2355},{"type":28,"tag":130,"props":2453,"children":2454},{"style":170},[2455],{"type":41,"value":2456},"'browser-type@024d5a494527ece580841844a9a933a6'",{"type":28,"tag":130,"props":2458,"children":2459},{"style":143},[2460],{"type":41,"value":2461}," },\n",{"type":28,"tag":130,"props":2463,"children":2464},{"class":132,"line":517},[2465,2470,2474,2478,2482,2487],{"type":28,"tag":130,"props":2466,"children":2467},{"style":159},[2468],{"type":41,"value":2469},"      firefox",{"type":28,"tag":130,"props":2471,"children":2472},{"style":143},[2473],{"type":41,"value":2442},{"type":28,"tag":130,"props":2475,"children":2476},{"style":159},[2477],{"type":41,"value":2447},{"type":28,"tag":130,"props":2479,"children":2480},{"style":143},[2481],{"type":41,"value":2355},{"type":28,"tag":130,"props":2483,"children":2484},{"style":170},[2485],{"type":41,"value":2486},"'browser-type@fae8f48651c02682ad3b276f0a046d63'",{"type":28,"tag":130,"props":2488,"children":2489},{"style":143},[2490],{"type":41,"value":2461},{"type":28,"tag":130,"props":2492,"children":2493},{"class":132,"line":562},[2494,2499,2503,2507,2511,2516],{"type":28,"tag":130,"props":2495,"children":2496},{"style":159},[2497],{"type":41,"value":2498},"      webkit",{"type":28,"tag":130,"props":2500,"children":2501},{"style":143},[2502],{"type":41,"value":2442},{"type":28,"tag":130,"props":2504,"children":2505},{"style":159},[2506],{"type":41,"value":2447},{"type":28,"tag":130,"props":2508,"children":2509},{"style":143},[2510],{"type":41,"value":2355},{"type":28,"tag":130,"props":2512,"children":2513},{"style":170},[2514],{"type":41,"value":2515},"'browser-type@ed1c30ab794ec863fe5b9b208c3635e1'",{"type":28,"tag":130,"props":2517,"children":2518},{"style":143},[2519],{"type":41,"value":2461},{"type":28,"tag":130,"props":2521,"children":2522},{"class":132,"line":570},[2523,2528,2532,2536,2540,2545],{"type":28,"tag":130,"props":2524,"children":2525},{"style":159},[2526],{"type":41,"value":2527},"      android",{"type":28,"tag":130,"props":2529,"children":2530},{"style":143},[2531],{"type":41,"value":2442},{"type":28,"tag":130,"props":2533,"children":2534},{"style":159},[2535],{"type":41,"value":2447},{"type":28,"tag":130,"props":2537,"children":2538},{"style":143},[2539],{"type":41,"value":2355},{"type":28,"tag":130,"props":2541,"children":2542},{"style":170},[2543],{"type":41,"value":2544},"'android@832582c466c24c6933d3a5587059e1be'",{"type":28,"tag":130,"props":2546,"children":2547},{"style":143},[2548],{"type":41,"value":2461},{"type":28,"tag":130,"props":2550,"children":2551},{"class":132,"line":579},[2552,2557,2561,2565,2569,2574],{"type":28,"tag":130,"props":2553,"children":2554},{"style":159},[2555],{"type":41,"value":2556},"      electron",{"type":28,"tag":130,"props":2558,"children":2559},{"style":143},[2560],{"type":41,"value":2442},{"type":28,"tag":130,"props":2562,"children":2563},{"style":159},[2564],{"type":41,"value":2447},{"type":28,"tag":130,"props":2566,"children":2567},{"style":143},[2568],{"type":41,"value":2355},{"type":28,"tag":130,"props":2570,"children":2571},{"style":170},[2572],{"type":41,"value":2573},"'electron@3829a7608477101154e15c1e25bca9ca'",{"type":28,"tag":130,"props":2575,"children":2576},{"style":143},[2577],{"type":41,"value":2461},{"type":28,"tag":130,"props":2579,"children":2580},{"class":132,"line":623},[2581],{"type":28,"tag":130,"props":2582,"children":2583},{"style":143},[2584],{"type":41,"value":2585},"    },\n",{"type":28,"tag":130,"props":2587,"children":2588},{"class":132,"line":22},[2589,2594,2598],{"type":28,"tag":130,"props":2590,"children":2591},{"style":159},[2592],{"type":41,"value":2593},"    guid",{"type":28,"tag":130,"props":2595,"children":2596},{"style":143},[2597],{"type":41,"value":2355},{"type":28,"tag":130,"props":2599,"children":2600},{"style":170},[2601],{"type":41,"value":2602},"'Playwright'\n",{"type":28,"tag":130,"props":2604,"children":2605},{"class":132,"line":667},[2606],{"type":28,"tag":130,"props":2607,"children":2608},{"style":143},[2609],{"type":41,"value":2610},"  }\n",{"type":28,"tag":130,"props":2612,"children":2613},{"class":132,"line":698},[2614],{"type":28,"tag":130,"props":2615,"children":2616},{"style":143},[2617],{"type":41,"value":1206},{"type":28,"tag":29,"props":2619,"children":2620},{},[2621,2623,2628,2630,2636,2638,2643,2645,2651,2653,2659,2661,2667],{"type":41,"value":2622},"note before this there are messages for each of the device types, and the ",{"type":28,"tag":44,"props":2624,"children":2626},{"className":2625},[],[2627],{"type":41,"value":1920},{"type":41,"value":2629}," constructs corresponding objects which provide a public API for these dispatchers within the server. These API's are provided by subclasses of the ",{"type":28,"tag":44,"props":2631,"children":2633},{"className":2632},[],[2634],{"type":41,"value":2635},"ChannelOwner",{"type":41,"value":2637}," class, which is a concept for a later section. For now, let's trace what happens in the ",{"type":28,"tag":44,"props":2639,"children":2641},{"className":2640},[],[2642],{"type":41,"value":1920},{"type":41,"value":2644}," for the ",{"type":28,"tag":44,"props":2646,"children":2648},{"className":2647},[],[2649],{"type":41,"value":2650},"type: 'Playwright'",{"type":41,"value":2652}," message. As mentioned before, the message is put through the ",{"type":28,"tag":44,"props":2654,"children":2656},{"className":2655},[],[2657],{"type":41,"value":2658},"clientConnection.dispatch",{"type":41,"value":2660}," function which then calls the ",{"type":28,"tag":44,"props":2662,"children":2664},{"className":2663},[],[2665],{"type":41,"value":2666},"clientConnection._createRemoteObject",{"type":41,"value":2668}," function with the following parameters",{"type":28,"tag":119,"props":2670,"children":2673},{"className":305,"code":2671,"filename":2672,"language":308,"meta":7,"style":7},"this._createRemoteObject(\n  '', // parentGuid - corresponds to Root, the root ChannelOwner\n  'Playwright', // type\n  'Playwright', // guid\n  { // initializer\n    chromium: { guid: 'browser-type@024d5a494527ece580841844a9a933a6' },\n    firefox: { guid: 'browser-type@fae8f48651c02682ad3b276f0a046d63' },\n    webkit: { guid: 'browser-type@ed1c30ab794ec863fe5b9b208c3635e1' },\n    android: { guid: 'android@832582c466c24c6933d3a5587059e1be' },\n    electron: { guid: 'electron@3829a7608477101154e15c1e25bca9ca' },\n  }\n)\n","packages/playwright-core/src/client/connection.ts",[2674],{"type":28,"tag":44,"props":2675,"children":2676},{"__ignoreMap":7},[2677,2697,2714,2731,2747,2760,2776,2792,2808,2824,2840,2847],{"type":28,"tag":130,"props":2678,"children":2679},{"class":132,"line":133},[2680,2684,2688,2692],{"type":28,"tag":130,"props":2681,"children":2682},{"style":137},[2683],{"type":41,"value":2123},{"type":28,"tag":130,"props":2685,"children":2686},{"style":143},[2687],{"type":41,"value":96},{"type":28,"tag":130,"props":2689,"children":2690},{"style":159},[2691],{"type":41,"value":2243},{"type":28,"tag":130,"props":2693,"children":2694},{"style":143},[2695],{"type":41,"value":2696},"(\n",{"type":28,"tag":130,"props":2698,"children":2699},{"class":132,"line":353},[2700,2705,2709],{"type":28,"tag":130,"props":2701,"children":2702},{"style":170},[2703],{"type":41,"value":2704},"  ''",{"type":28,"tag":130,"props":2706,"children":2707},{"style":143},[2708],{"type":41,"value":487},{"type":28,"tag":130,"props":2710,"children":2711},{"style":552},[2712],{"type":41,"value":2713},"// parentGuid - corresponds to Root, the root ChannelOwner\n",{"type":28,"tag":130,"props":2715,"children":2716},{"class":132,"line":381},[2717,2722,2726],{"type":28,"tag":130,"props":2718,"children":2719},{"style":170},[2720],{"type":41,"value":2721},"  'Playwright'",{"type":28,"tag":130,"props":2723,"children":2724},{"style":143},[2725],{"type":41,"value":487},{"type":28,"tag":130,"props":2727,"children":2728},{"style":552},[2729],{"type":41,"value":2730},"// type\n",{"type":28,"tag":130,"props":2732,"children":2733},{"class":132,"line":430},[2734,2738,2742],{"type":28,"tag":130,"props":2735,"children":2736},{"style":170},[2737],{"type":41,"value":2721},{"type":28,"tag":130,"props":2739,"children":2740},{"style":143},[2741],{"type":41,"value":487},{"type":28,"tag":130,"props":2743,"children":2744},{"style":552},[2745],{"type":41,"value":2746},"// guid\n",{"type":28,"tag":130,"props":2748,"children":2749},{"class":132,"line":439},[2750,2755],{"type":28,"tag":130,"props":2751,"children":2752},{"style":143},[2753],{"type":41,"value":2754},"  { ",{"type":28,"tag":130,"props":2756,"children":2757},{"style":552},[2758],{"type":41,"value":2759},"// initializer\n",{"type":28,"tag":130,"props":2761,"children":2762},{"class":132,"line":449},[2763,2768,2772],{"type":28,"tag":130,"props":2764,"children":2765},{"style":143},[2766],{"type":41,"value":2767},"    chromium: { guid: ",{"type":28,"tag":130,"props":2769,"children":2770},{"style":170},[2771],{"type":41,"value":2456},{"type":28,"tag":130,"props":2773,"children":2774},{"style":143},[2775],{"type":41,"value":2461},{"type":28,"tag":130,"props":2777,"children":2778},{"class":132,"line":498},[2779,2784,2788],{"type":28,"tag":130,"props":2780,"children":2781},{"style":143},[2782],{"type":41,"value":2783},"    firefox: { guid: ",{"type":28,"tag":130,"props":2785,"children":2786},{"style":170},[2787],{"type":41,"value":2486},{"type":28,"tag":130,"props":2789,"children":2790},{"style":143},[2791],{"type":41,"value":2461},{"type":28,"tag":130,"props":2793,"children":2794},{"class":132,"line":517},[2795,2800,2804],{"type":28,"tag":130,"props":2796,"children":2797},{"style":143},[2798],{"type":41,"value":2799},"    webkit: { guid: ",{"type":28,"tag":130,"props":2801,"children":2802},{"style":170},[2803],{"type":41,"value":2515},{"type":28,"tag":130,"props":2805,"children":2806},{"style":143},[2807],{"type":41,"value":2461},{"type":28,"tag":130,"props":2809,"children":2810},{"class":132,"line":562},[2811,2816,2820],{"type":28,"tag":130,"props":2812,"children":2813},{"style":143},[2814],{"type":41,"value":2815},"    android: { guid: ",{"type":28,"tag":130,"props":2817,"children":2818},{"style":170},[2819],{"type":41,"value":2544},{"type":28,"tag":130,"props":2821,"children":2822},{"style":143},[2823],{"type":41,"value":2461},{"type":28,"tag":130,"props":2825,"children":2826},{"class":132,"line":570},[2827,2832,2836],{"type":28,"tag":130,"props":2828,"children":2829},{"style":143},[2830],{"type":41,"value":2831},"    electron: { guid: ",{"type":28,"tag":130,"props":2833,"children":2834},{"style":170},[2835],{"type":41,"value":2573},{"type":28,"tag":130,"props":2837,"children":2838},{"style":143},[2839],{"type":41,"value":2461},{"type":28,"tag":130,"props":2841,"children":2842},{"class":132,"line":579},[2843],{"type":28,"tag":130,"props":2844,"children":2845},{"style":143},[2846],{"type":41,"value":2610},{"type":28,"tag":130,"props":2848,"children":2849},{"class":132,"line":623},[2850],{"type":28,"tag":130,"props":2851,"children":2852},{"style":143},[2853],{"type":41,"value":2854},")\n",{"type":28,"tag":29,"props":2856,"children":2857},{},[2858,2860,2865,2867,2873],{"type":41,"value":2859},"in the ",{"type":28,"tag":44,"props":2861,"children":2863},{"className":2862},[],[2864],{"type":41,"value":2666},{"type":41,"value":2866}," function, there is a transformation of the data and then a large ",{"type":28,"tag":44,"props":2868,"children":2870},{"className":2869},[],[2871],{"type":41,"value":2872},"switch-case",{"type":41,"value":2874}," function instantiating the corresponding client class.",{"type":28,"tag":119,"props":2876,"children":2878},{"className":305,"code":2877,"filename":2672,"language":308,"meta":7,"style":7},"_createRemoteObject(parentGuid: string, type: string, guid: string, initializer: any) {\n  const parent = this._objects.get(parentGuid); // here the parentGuid is ''\n  if (!parent)\n    throw new Error(`Cannot find parent object ${parentGuid} to create ${guid}`);\n  let result: ChannelOwner\u003Cany>;\n  const validator = findValidator(type, '', 'Initializer');\n  initializer = validator(\n    initializer,\n    '',\n    {\n      tChannelImpl: this._tChannelImplFromWire.bind(this),\n      binary: this._rawBuffers ? 'buffer' : 'fromBase64'\n    }\n  );\n  switch (type) {\n    // ...\n    case 'Playwright':\n      result = new Playwright(parent, type, guid, initializer);\n      break;\n    // ...\n  }\n  return result;\n}\n",[2879],{"type":28,"tag":44,"props":2880,"children":2881},{"__ignoreMap":7},[2882,2894,2934,2955,3004,3041,3080,3099,3107,3119,3127,3161,3195,3203,3211,3224,3232,3250,3276,3288,3295,3302,3314],{"type":28,"tag":130,"props":2883,"children":2884},{"class":132,"line":133},[2885,2889],{"type":28,"tag":130,"props":2886,"children":2887},{"style":159},[2888],{"type":41,"value":2243},{"type":28,"tag":130,"props":2890,"children":2891},{"style":143},[2892],{"type":41,"value":2893},"(parentGuid: string, type: string, guid: string, initializer: any) {\n",{"type":28,"tag":130,"props":2895,"children":2896},{"class":132,"line":353},[2897,2901,2906,2910,2915,2920,2924,2929],{"type":28,"tag":130,"props":2898,"children":2899},{"style":153},[2900],{"type":41,"value":359},{"type":28,"tag":130,"props":2902,"children":2903},{"style":137},[2904],{"type":41,"value":2905}," parent",{"type":28,"tag":130,"props":2907,"children":2908},{"style":153},[2909],{"type":41,"value":156},{"type":28,"tag":130,"props":2911,"children":2912},{"style":137},[2913],{"type":41,"value":2914}," this",{"type":28,"tag":130,"props":2916,"children":2917},{"style":143},[2918],{"type":41,"value":2919},"._objects.",{"type":28,"tag":130,"props":2921,"children":2922},{"style":159},[2923],{"type":41,"value":1107},{"type":28,"tag":130,"props":2925,"children":2926},{"style":143},[2927],{"type":41,"value":2928},"(parentGuid); ",{"type":28,"tag":130,"props":2930,"children":2931},{"style":552},[2932],{"type":41,"value":2933},"// here the parentGuid is ''\n",{"type":28,"tag":130,"props":2935,"children":2936},{"class":132,"line":381},[2937,2942,2946,2950],{"type":28,"tag":130,"props":2938,"children":2939},{"style":153},[2940],{"type":41,"value":2941},"  if",{"type":28,"tag":130,"props":2943,"children":2944},{"style":143},[2945],{"type":41,"value":1061},{"type":28,"tag":130,"props":2947,"children":2948},{"style":153},[2949],{"type":41,"value":1117},{"type":28,"tag":130,"props":2951,"children":2952},{"style":143},[2953],{"type":41,"value":2954},"parent)\n",{"type":28,"tag":130,"props":2956,"children":2957},{"class":132,"line":430},[2958,2963,2967,2972,2976,2981,2986,2991,2995,3000],{"type":28,"tag":130,"props":2959,"children":2960},{"style":153},[2961],{"type":41,"value":2962},"    throw",{"type":28,"tag":130,"props":2964,"children":2965},{"style":153},[2966],{"type":41,"value":468},{"type":28,"tag":130,"props":2968,"children":2969},{"style":159},[2970],{"type":41,"value":2971}," Error",{"type":28,"tag":130,"props":2973,"children":2974},{"style":143},[2975],{"type":41,"value":167},{"type":28,"tag":130,"props":2977,"children":2978},{"style":170},[2979],{"type":41,"value":2980},"`Cannot find parent object ${",{"type":28,"tag":130,"props":2982,"children":2983},{"style":143},[2984],{"type":41,"value":2985},"parentGuid",{"type":28,"tag":130,"props":2987,"children":2988},{"style":170},[2989],{"type":41,"value":2990},"} to create ${",{"type":28,"tag":130,"props":2992,"children":2993},{"style":143},[2994],{"type":41,"value":2447},{"type":28,"tag":130,"props":2996,"children":2997},{"style":170},[2998],{"type":41,"value":2999},"}`",{"type":28,"tag":130,"props":3001,"children":3002},{"style":143},[3003],{"type":41,"value":178},{"type":28,"tag":130,"props":3005,"children":3006},{"class":132,"line":439},[3007,3012,3017,3021,3026,3031,3036],{"type":28,"tag":130,"props":3008,"children":3009},{"style":153},[3010],{"type":41,"value":3011},"  let",{"type":28,"tag":130,"props":3013,"children":3014},{"style":143},[3015],{"type":41,"value":3016}," result",{"type":28,"tag":130,"props":3018,"children":3019},{"style":153},[3020],{"type":41,"value":340},{"type":28,"tag":130,"props":3022,"children":3023},{"style":159},[3024],{"type":41,"value":3025}," ChannelOwner",{"type":28,"tag":130,"props":3027,"children":3028},{"style":143},[3029],{"type":41,"value":3030},"\u003C",{"type":28,"tag":130,"props":3032,"children":3033},{"style":137},[3034],{"type":41,"value":3035},"any",{"type":28,"tag":130,"props":3037,"children":3038},{"style":143},[3039],{"type":41,"value":3040},">;\n",{"type":28,"tag":130,"props":3042,"children":3043},{"class":132,"line":449},[3044,3048,3052,3056,3060,3064,3068,3072,3076],{"type":28,"tag":130,"props":3045,"children":3046},{"style":153},[3047],{"type":41,"value":359},{"type":28,"tag":130,"props":3049,"children":3050},{"style":137},[3051],{"type":41,"value":2057},{"type":28,"tag":130,"props":3053,"children":3054},{"style":153},[3055],{"type":41,"value":156},{"type":28,"tag":130,"props":3057,"children":3058},{"style":159},[3059],{"type":41,"value":2066},{"type":28,"tag":130,"props":3061,"children":3062},{"style":143},[3063],{"type":41,"value":2071},{"type":28,"tag":130,"props":3065,"children":3066},{"style":170},[3067],{"type":41,"value":1148},{"type":28,"tag":130,"props":3069,"children":3070},{"style":143},[3071],{"type":41,"value":487},{"type":28,"tag":130,"props":3073,"children":3074},{"style":170},[3075],{"type":41,"value":2084},{"type":28,"tag":130,"props":3077,"children":3078},{"style":143},[3079],{"type":41,"value":178},{"type":28,"tag":130,"props":3081,"children":3082},{"class":132,"line":498},[3083,3087,3091,3095],{"type":28,"tag":130,"props":3084,"children":3085},{"style":143},[3086],{"type":41,"value":2096},{"type":28,"tag":130,"props":3088,"children":3089},{"style":153},[3090],{"type":41,"value":798},{"type":28,"tag":130,"props":3092,"children":3093},{"style":159},[3094],{"type":41,"value":2057},{"type":28,"tag":130,"props":3096,"children":3097},{"style":143},[3098],{"type":41,"value":2696},{"type":28,"tag":130,"props":3100,"children":3101},{"class":132,"line":517},[3102],{"type":28,"tag":130,"props":3103,"children":3104},{"style":143},[3105],{"type":41,"value":3106},"    initializer,\n",{"type":28,"tag":130,"props":3108,"children":3109},{"class":132,"line":562},[3110,3115],{"type":28,"tag":130,"props":3111,"children":3112},{"style":170},[3113],{"type":41,"value":3114},"    ''",{"type":28,"tag":130,"props":3116,"children":3117},{"style":143},[3118],{"type":41,"value":2364},{"type":28,"tag":130,"props":3120,"children":3121},{"class":132,"line":570},[3122],{"type":28,"tag":130,"props":3123,"children":3124},{"style":143},[3125],{"type":41,"value":3126},"    {\n",{"type":28,"tag":130,"props":3128,"children":3129},{"class":132,"line":579},[3130,3135,3139,3144,3148,3152,3156],{"type":28,"tag":130,"props":3131,"children":3132},{"style":143},[3133],{"type":41,"value":3134},"      tChannelImpl: ",{"type":28,"tag":130,"props":3136,"children":3137},{"style":137},[3138],{"type":41,"value":2123},{"type":28,"tag":130,"props":3140,"children":3141},{"style":143},[3142],{"type":41,"value":3143},"._tChannelImplFromWire.",{"type":28,"tag":130,"props":3145,"children":3146},{"style":159},[3147],{"type":41,"value":2133},{"type":28,"tag":130,"props":3149,"children":3150},{"style":143},[3151],{"type":41,"value":167},{"type":28,"tag":130,"props":3153,"children":3154},{"style":137},[3155],{"type":41,"value":2123},{"type":28,"tag":130,"props":3157,"children":3158},{"style":143},[3159],{"type":41,"value":3160},"),\n",{"type":28,"tag":130,"props":3162,"children":3163},{"class":132,"line":623},[3164,3169,3173,3178,3182,3186,3190],{"type":28,"tag":130,"props":3165,"children":3166},{"style":143},[3167],{"type":41,"value":3168},"      binary: ",{"type":28,"tag":130,"props":3170,"children":3171},{"style":137},[3172],{"type":41,"value":2123},{"type":28,"tag":130,"props":3174,"children":3175},{"style":143},[3176],{"type":41,"value":3177},"._rawBuffers ",{"type":28,"tag":130,"props":3179,"children":3180},{"style":153},[3181],{"type":41,"value":2160},{"type":28,"tag":130,"props":3183,"children":3184},{"style":170},[3185],{"type":41,"value":2165},{"type":28,"tag":130,"props":3187,"children":3188},{"style":153},[3189],{"type":41,"value":2170},{"type":28,"tag":130,"props":3191,"children":3192},{"style":170},[3193],{"type":41,"value":3194}," 'fromBase64'\n",{"type":28,"tag":130,"props":3196,"children":3197},{"class":132,"line":22},[3198],{"type":28,"tag":130,"props":3199,"children":3200},{"style":143},[3201],{"type":41,"value":3202},"    }\n",{"type":28,"tag":130,"props":3204,"children":3205},{"class":132,"line":667},[3206],{"type":28,"tag":130,"props":3207,"children":3208},{"style":143},[3209],{"type":41,"value":3210},"  );\n",{"type":28,"tag":130,"props":3212,"children":3213},{"class":132,"line":698},[3214,3219],{"type":28,"tag":130,"props":3215,"children":3216},{"style":153},[3217],{"type":41,"value":3218},"  switch",{"type":28,"tag":130,"props":3220,"children":3221},{"style":143},[3222],{"type":41,"value":3223}," (type) {\n",{"type":28,"tag":130,"props":3225,"children":3226},{"class":132,"line":706},[3227],{"type":28,"tag":130,"props":3228,"children":3229},{"style":552},[3230],{"type":41,"value":3231},"    // ...\n",{"type":28,"tag":130,"props":3233,"children":3234},{"class":132,"line":715},[3235,3240,3245],{"type":28,"tag":130,"props":3236,"children":3237},{"style":153},[3238],{"type":41,"value":3239},"    case",{"type":28,"tag":130,"props":3241,"children":3242},{"style":170},[3243],{"type":41,"value":3244}," 'Playwright'",{"type":28,"tag":130,"props":3246,"children":3247},{"style":143},[3248],{"type":41,"value":3249},":\n",{"type":28,"tag":130,"props":3251,"children":3252},{"class":132,"line":734},[3253,3258,3262,3266,3271],{"type":28,"tag":130,"props":3254,"children":3255},{"style":143},[3256],{"type":41,"value":3257},"      result ",{"type":28,"tag":130,"props":3259,"children":3260},{"style":153},[3261],{"type":41,"value":798},{"type":28,"tag":130,"props":3263,"children":3264},{"style":153},[3265],{"type":41,"value":468},{"type":28,"tag":130,"props":3267,"children":3268},{"style":159},[3269],{"type":41,"value":3270}," Playwright",{"type":28,"tag":130,"props":3272,"children":3273},{"style":143},[3274],{"type":41,"value":3275},"(parent, type, guid, initializer);\n",{"type":28,"tag":130,"props":3277,"children":3278},{"class":132,"line":787},[3279,3284],{"type":28,"tag":130,"props":3280,"children":3281},{"style":153},[3282],{"type":41,"value":3283},"      break",{"type":28,"tag":130,"props":3285,"children":3286},{"style":143},[3287],{"type":41,"value":784},{"type":28,"tag":130,"props":3289,"children":3290},{"class":132,"line":823},[3291],{"type":28,"tag":130,"props":3292,"children":3293},{"style":552},[3294],{"type":41,"value":3231},{"type":28,"tag":130,"props":3296,"children":3297},{"class":132,"line":857},[3298],{"type":28,"tag":130,"props":3299,"children":3300},{"style":143},[3301],{"type":41,"value":2610},{"type":28,"tag":130,"props":3303,"children":3304},{"class":132,"line":891},[3305,3309],{"type":28,"tag":130,"props":3306,"children":3307},{"style":153},[3308],{"type":41,"value":1192},{"type":28,"tag":130,"props":3310,"children":3311},{"style":143},[3312],{"type":41,"value":3313}," result;\n",{"type":28,"tag":130,"props":3315,"children":3316},{"class":132,"line":917},[3317],{"type":28,"tag":130,"props":3318,"children":3319},{"style":143},[3320],{"type":41,"value":1206},{"type":28,"tag":29,"props":3322,"children":3323},{},[3324,3326,3332,3334,3340,3342,3348,3350,3355,3357,3362,3364,3369,3371,3376,3378,3384,3386,3391,3393,3398,3400,3406],{"type":41,"value":3325},"The parameter ",{"type":28,"tag":44,"props":3327,"children":3329},{"className":3328},[],[3330],{"type":41,"value":3331},"tChannelImpl: _tChannelImplFromWire",{"type":41,"value":3333}," in the ",{"type":28,"tag":44,"props":3335,"children":3337},{"className":3336},[],[3338],{"type":41,"value":3339},"validator",{"type":41,"value":3341}," function is responsible for taking the initializer object above, which contains a guid for each browser, and convert it to the corresponding object stored in the ",{"type":28,"tag":44,"props":3343,"children":3345},{"className":3344},[],[3346],{"type":41,"value":3347},"_objects",{"type":41,"value":3349}," variable in the ",{"type":28,"tag":44,"props":3351,"children":3353},{"className":3352},[],[3354],{"type":41,"value":1247},{"type":41,"value":3356}," class. If you look at the type definition in ",{"type":28,"tag":44,"props":3358,"children":3360},{"className":3359},[],[3361],{"type":41,"value":1247},{"type":41,"value":3363}," the ",{"type":28,"tag":44,"props":3365,"children":3367},{"className":3366},[],[3368],{"type":41,"value":3347},{"type":41,"value":3370}," variable is a map returning one of the ",{"type":28,"tag":44,"props":3372,"children":3374},{"className":3373},[],[3375],{"type":41,"value":2635},{"type":41,"value":3377}," subclasses. So in the result above for the ",{"type":28,"tag":44,"props":3379,"children":3381},{"className":3380},[],[3382],{"type":41,"value":3383},"case: 'Playwright'",{"type":41,"value":3385},", it returns a ",{"type":28,"tag":44,"props":3387,"children":3389},{"className":3388},[],[3390],{"type":41,"value":12},{"type":41,"value":3392}," instance, which is a subclass of ",{"type":28,"tag":44,"props":3394,"children":3396},{"className":3395},[],[3397],{"type":41,"value":2635},{"type":41,"value":3399},", defined in ",{"type":28,"tag":44,"props":3401,"children":3403},{"className":3402},[],[3404],{"type":41,"value":3405},"client/playwright.ts",{"type":41,"value":96},{"type":28,"tag":119,"props":3408,"children":3410},{"className":305,"code":3409,"filename":2672,"language":308,"meta":7,"style":7},"class Connection extends EventEmitter {\n  _objects: Map\u003CString, ChannelOwner>\n}\n",[3411],{"type":28,"tag":44,"props":3412,"children":3413},{"__ignoreMap":7},[3414,3440,3479],{"type":28,"tag":130,"props":3415,"children":3416},{"class":132,"line":133},[3417,3422,3426,3431,3436],{"type":28,"tag":130,"props":3418,"children":3419},{"style":153},[3420],{"type":41,"value":3421},"class",{"type":28,"tag":130,"props":3423,"children":3424},{"style":159},[3425],{"type":41,"value":473},{"type":28,"tag":130,"props":3427,"children":3428},{"style":153},[3429],{"type":41,"value":3430}," extends",{"type":28,"tag":130,"props":3432,"children":3433},{"style":159},[3434],{"type":41,"value":3435}," EventEmitter",{"type":28,"tag":130,"props":3437,"children":3438},{"style":143},[3439],{"type":41,"value":350},{"type":28,"tag":130,"props":3441,"children":3442},{"class":132,"line":353},[3443,3448,3452,3457,3461,3466,3470,3474],{"type":28,"tag":130,"props":3444,"children":3445},{"style":597},[3446],{"type":41,"value":3447},"  _objects",{"type":28,"tag":130,"props":3449,"children":3450},{"style":153},[3451],{"type":41,"value":340},{"type":28,"tag":130,"props":3453,"children":3454},{"style":159},[3455],{"type":41,"value":3456}," Map",{"type":28,"tag":130,"props":3458,"children":3459},{"style":143},[3460],{"type":41,"value":3030},{"type":28,"tag":130,"props":3462,"children":3463},{"style":159},[3464],{"type":41,"value":3465},"String",{"type":28,"tag":130,"props":3467,"children":3468},{"style":143},[3469],{"type":41,"value":487},{"type":28,"tag":130,"props":3471,"children":3472},{"style":159},[3473],{"type":41,"value":2635},{"type":28,"tag":130,"props":3475,"children":3476},{"style":143},[3477],{"type":41,"value":3478},">\n",{"type":28,"tag":130,"props":3480,"children":3481},{"class":132,"line":381},[3482],{"type":28,"tag":130,"props":3483,"children":3484},{"style":143},[3485],{"type":41,"value":1206},{"type":28,"tag":29,"props":3487,"children":3488},{},[3489,3490,3496,3498,3504,3506,3511,3513,3518,3520,3525,3527,3533,3535,3541,3542,3547,3549,3555,3557,3562],{"type":41,"value":1979},{"type":28,"tag":44,"props":3491,"children":3493},{"className":3492},[],[3494],{"type":41,"value":3495},"_tChannelImplFromWire",{"type":41,"value":3497}," function is responsible for turning the ",{"type":28,"tag":44,"props":3499,"children":3501},{"className":3500},[],[3502],{"type":41,"value":3503},"initializer",{"type":41,"value":3505}," parameter in the constructor for ",{"type":28,"tag":44,"props":3507,"children":3509},{"className":3508},[],[3510],{"type":41,"value":12},{"type":41,"value":3512}," into the ",{"type":28,"tag":44,"props":3514,"children":3516},{"className":3515},[],[3517],{"type":41,"value":2635},{"type":41,"value":3519}," subclasses for each of the drivers (chrome, firefox, etc.). Note before the ",{"type":28,"tag":44,"props":3521,"children":3523},{"className":3522},[],[3524],{"type":41,"value":12},{"type":41,"value":3526}," message was sent over to the client, there were messages for each of the ",{"type":28,"tag":44,"props":3528,"children":3530},{"className":3529},[],[3531],{"type":41,"value":3532},"BrowserType",{"type":41,"value":3534}," objects with name ",{"type":28,"tag":44,"props":3536,"children":3538},{"className":3537},[],[3539],{"type":41,"value":3540},"'chrome'",{"type":41,"value":487},{"type":28,"tag":44,"props":3543,"children":3545},{"className":3544},[],[3546],{"type":41,"value":850},{"type":41,"value":3548},", etc. If you inspect this object manually, you will find many ",{"type":28,"tag":44,"props":3550,"children":3552},{"className":3551},[],[3553],{"type":41,"value":3554},"EventEmitter",{"type":41,"value":3556}," objects in the ",{"type":28,"tag":44,"props":3558,"children":3560},{"className":3559},[],[3561],{"type":41,"value":3503},{"type":41,"value":3563}," object.",{"type":28,"tag":29,"props":3565,"children":3566},{},[3567,3569,3575,3577,3583,3585,3591,3593,3598,3600,3606,3608,3613,3615,3620,3622,3627],{"type":41,"value":3568},"The other main point to note is the ",{"type":28,"tag":44,"props":3570,"children":3572},{"className":3571},[],[3573],{"type":41,"value":3574},"Root",{"type":41,"value":3576}," design pattern is used on the client side as well. The ",{"type":28,"tag":44,"props":3578,"children":3580},{"className":3579},[],[3581],{"type":41,"value":3582},"parent",{"type":41,"value":3584}," corresponding to the ",{"type":28,"tag":44,"props":3586,"children":3588},{"className":3587},[],[3589],{"type":41,"value":3590},"guid=''",{"type":41,"value":3592}," is an instance of the ",{"type":28,"tag":44,"props":3594,"children":3596},{"className":3595},[],[3597],{"type":41,"value":3574},{"type":41,"value":3599}," class, defined in ",{"type":28,"tag":44,"props":3601,"children":3603},{"className":3602},[],[3604],{"type":41,"value":3605},"client/connection.ts",{"type":41,"value":3607},". All this class acts as is a wrapper around the ",{"type":28,"tag":44,"props":3609,"children":3611},{"className":3610},[],[3612],{"type":41,"value":1920},{"type":41,"value":3614},", giving every subclass of ",{"type":28,"tag":44,"props":3616,"children":3618},{"className":3617},[],[3619],{"type":41,"value":2635},{"type":41,"value":3621}," access to the ",{"type":28,"tag":44,"props":3623,"children":3625},{"className":3624},[],[3626],{"type":41,"value":1920},{"type":41,"value":3628}," to send messages over to the Playwright server.",{"type":28,"tag":1208,"props":3630,"children":3632},{"id":3631},"launching-the-browser-instance",[3633],{"type":41,"value":3634},"Launching the browser instance",{"type":28,"tag":29,"props":3636,"children":3637},{},[3638,3640,3646],{"type":41,"value":3639},"The final bit of code to consider is the ",{"type":28,"tag":44,"props":3641,"children":3643},{"className":3642},[],[3644],{"type":41,"value":3645},"_serverLauncher",{"type":41,"value":3647}," variables being set in each of the drivers. This is written as",{"type":28,"tag":119,"props":3649,"children":3651},{"className":305,"code":3650,"filename":307,"language":308,"meta":7,"style":7},"playwrightAPI.chromium._serverLauncher = new BrowserServerLauncherImpl('chromium');\nplaywrightAPI.firefox._serverLauncher = new BrowserServerLauncherImpl('firefox');\nplaywrightAPI.webkit._serverLauncher = new BrowserServerLauncherImpl('webkit');\n",[3652],{"type":28,"tag":44,"props":3653,"children":3654},{"__ignoreMap":7},[3655,3687,3719],{"type":28,"tag":130,"props":3656,"children":3657},{"class":132,"line":133},[3658,3663,3667,3671,3675,3679,3683],{"type":28,"tag":130,"props":3659,"children":3660},{"style":143},[3661],{"type":41,"value":3662},"playwrightAPI.chromium._serverLauncher ",{"type":28,"tag":130,"props":3664,"children":3665},{"style":153},[3666],{"type":41,"value":798},{"type":28,"tag":130,"props":3668,"children":3669},{"style":153},[3670],{"type":41,"value":468},{"type":28,"tag":130,"props":3672,"children":3673},{"style":159},[3674],{"type":41,"value":807},{"type":28,"tag":130,"props":3676,"children":3677},{"style":143},[3678],{"type":41,"value":167},{"type":28,"tag":130,"props":3680,"children":3681},{"style":170},[3682],{"type":41,"value":816},{"type":28,"tag":130,"props":3684,"children":3685},{"style":143},[3686],{"type":41,"value":178},{"type":28,"tag":130,"props":3688,"children":3689},{"class":132,"line":353},[3690,3695,3699,3703,3707,3711,3715],{"type":28,"tag":130,"props":3691,"children":3692},{"style":143},[3693],{"type":41,"value":3694},"playwrightAPI.firefox._serverLauncher ",{"type":28,"tag":130,"props":3696,"children":3697},{"style":153},[3698],{"type":41,"value":798},{"type":28,"tag":130,"props":3700,"children":3701},{"style":153},[3702],{"type":41,"value":468},{"type":28,"tag":130,"props":3704,"children":3705},{"style":159},[3706],{"type":41,"value":807},{"type":28,"tag":130,"props":3708,"children":3709},{"style":143},[3710],{"type":41,"value":167},{"type":28,"tag":130,"props":3712,"children":3713},{"style":170},[3714],{"type":41,"value":850},{"type":28,"tag":130,"props":3716,"children":3717},{"style":143},[3718],{"type":41,"value":178},{"type":28,"tag":130,"props":3720,"children":3721},{"class":132,"line":381},[3722,3727,3731,3735,3739,3743,3747],{"type":28,"tag":130,"props":3723,"children":3724},{"style":143},[3725],{"type":41,"value":3726},"playwrightAPI.webkit._serverLauncher ",{"type":28,"tag":130,"props":3728,"children":3729},{"style":153},[3730],{"type":41,"value":798},{"type":28,"tag":130,"props":3732,"children":3733},{"style":153},[3734],{"type":41,"value":468},{"type":28,"tag":130,"props":3736,"children":3737},{"style":159},[3738],{"type":41,"value":807},{"type":28,"tag":130,"props":3740,"children":3741},{"style":143},[3742],{"type":41,"value":167},{"type":28,"tag":130,"props":3744,"children":3745},{"style":170},[3746],{"type":41,"value":884},{"type":28,"tag":130,"props":3748,"children":3749},{"style":143},[3750],{"type":41,"value":178},{"type":28,"tag":29,"props":3752,"children":3753},{},[3754,3755,3761,3763,3768,3770,3776,3778,3784],{"type":41,"value":183},{"type":28,"tag":44,"props":3756,"children":3758},{"className":3757},[],[3759],{"type":41,"value":3760},"BrowserServerLauncherImpl",{"type":41,"value":3762}," class is defined next to the ",{"type":28,"tag":44,"props":3764,"children":3766},{"className":3765},[],[3767],{"type":41,"value":213},{"type":41,"value":3769}," file in ",{"type":28,"tag":44,"props":3771,"children":3773},{"className":3772},[],[3774],{"type":41,"value":3775},"browserServerLauncherImpl.ts",{"type":41,"value":3777},". The main functionality in this class lies in the ",{"type":28,"tag":44,"props":3779,"children":3781},{"className":3780},[],[3782],{"type":41,"value":3783},"launchServer",{"type":41,"value":3785}," function, and is only called when you use the",{"type":28,"tag":119,"props":3787,"children":3790},{"className":305,"code":3788,"filename":3789,"language":308,"meta":7,"style":7},"playwrightAPI.chromium.launchServer(serverOptions)\n","my-script.ts",[3791],{"type":28,"tag":44,"props":3792,"children":3793},{"__ignoreMap":7},[3794],{"type":28,"tag":130,"props":3795,"children":3796},{"class":132,"line":133},[3797,3802,3806],{"type":28,"tag":130,"props":3798,"children":3799},{"style":143},[3800],{"type":41,"value":3801},"playwrightAPI.chromium.",{"type":28,"tag":130,"props":3803,"children":3804},{"style":159},[3805],{"type":41,"value":3783},{"type":28,"tag":130,"props":3807,"children":3808},{"style":143},[3809],{"type":41,"value":3810},"(serverOptions)\n",{"type":28,"tag":29,"props":3812,"children":3813},{},[3814,3816,3822],{"type":41,"value":3815},"function. This is for launching a server which exposes a websocket for other programs to interact with the playwright API. This is not used if you are just writing a node script which accesses the ",{"type":28,"tag":44,"props":3817,"children":3819},{"className":3818},[],[3820],{"type":41,"value":3821},"'playwright-core'",{"type":41,"value":3823}," library, something like",{"type":28,"tag":119,"props":3825,"children":3827},{"className":305,"code":3826,"filename":3789,"language":308,"meta":7,"style":7},"import playwright from 'playwright-core';\n\n(async function () {\n  const browser = await playwright.chromium.launch({headless: false})\n  const page = await browser.newPage()\n  await page.goto(\"https://playwright.dev\")\n  // ... automate page interactions here\n})()\n",[3828],{"type":28,"tag":44,"props":3829,"children":3830},{"__ignoreMap":7},[3831,3856,3863,3884,3930,3965,3996,4004],{"type":28,"tag":130,"props":3832,"children":3833},{"class":132,"line":133},[3834,3838,3843,3847,3852],{"type":28,"tag":130,"props":3835,"children":3836},{"style":153},[3837],{"type":41,"value":1444},{"type":28,"tag":130,"props":3839,"children":3840},{"style":143},[3841],{"type":41,"value":3842}," playwright ",{"type":28,"tag":130,"props":3844,"children":3845},{"style":153},[3846],{"type":41,"value":1454},{"type":28,"tag":130,"props":3848,"children":3849},{"style":170},[3850],{"type":41,"value":3851}," 'playwright-core'",{"type":28,"tag":130,"props":3853,"children":3854},{"style":143},[3855],{"type":41,"value":784},{"type":28,"tag":130,"props":3857,"children":3858},{"class":132,"line":353},[3859],{"type":28,"tag":130,"props":3860,"children":3861},{"emptyLinePlaceholder":443},[3862],{"type":41,"value":446},{"type":28,"tag":130,"props":3864,"children":3865},{"class":132,"line":381},[3866,3870,3875,3879],{"type":28,"tag":130,"props":3867,"children":3868},{"style":143},[3869],{"type":41,"value":167},{"type":28,"tag":130,"props":3871,"children":3872},{"style":153},[3873],{"type":41,"value":3874},"async",{"type":28,"tag":130,"props":3876,"children":3877},{"style":153},[3878],{"type":41,"value":325},{"type":28,"tag":130,"props":3880,"children":3881},{"style":143},[3882],{"type":41,"value":3883}," () {\n",{"type":28,"tag":130,"props":3885,"children":3886},{"class":132,"line":430},[3887,3891,3896,3900,3905,3910,3915,3920,3925],{"type":28,"tag":130,"props":3888,"children":3889},{"style":153},[3890],{"type":41,"value":359},{"type":28,"tag":130,"props":3892,"children":3893},{"style":137},[3894],{"type":41,"value":3895}," browser",{"type":28,"tag":130,"props":3897,"children":3898},{"style":153},[3899],{"type":41,"value":156},{"type":28,"tag":130,"props":3901,"children":3902},{"style":153},[3903],{"type":41,"value":3904}," await",{"type":28,"tag":130,"props":3906,"children":3907},{"style":143},[3908],{"type":41,"value":3909}," playwright.chromium.",{"type":28,"tag":130,"props":3911,"children":3912},{"style":159},[3913],{"type":41,"value":3914},"launch",{"type":28,"tag":130,"props":3916,"children":3917},{"style":143},[3918],{"type":41,"value":3919},"({headless: ",{"type":28,"tag":130,"props":3921,"children":3922},{"style":137},[3923],{"type":41,"value":3924},"false",{"type":28,"tag":130,"props":3926,"children":3927},{"style":143},[3928],{"type":41,"value":3929},"})\n",{"type":28,"tag":130,"props":3931,"children":3932},{"class":132,"line":439},[3933,3937,3942,3946,3950,3955,3960],{"type":28,"tag":130,"props":3934,"children":3935},{"style":153},[3936],{"type":41,"value":359},{"type":28,"tag":130,"props":3938,"children":3939},{"style":137},[3940],{"type":41,"value":3941}," page",{"type":28,"tag":130,"props":3943,"children":3944},{"style":153},[3945],{"type":41,"value":156},{"type":28,"tag":130,"props":3947,"children":3948},{"style":153},[3949],{"type":41,"value":3904},{"type":28,"tag":130,"props":3951,"children":3952},{"style":143},[3953],{"type":41,"value":3954}," browser.",{"type":28,"tag":130,"props":3956,"children":3957},{"style":159},[3958],{"type":41,"value":3959},"newPage",{"type":28,"tag":130,"props":3961,"children":3962},{"style":143},[3963],{"type":41,"value":3964},"()\n",{"type":28,"tag":130,"props":3966,"children":3967},{"class":132,"line":449},[3968,3973,3978,3983,3987,3992],{"type":28,"tag":130,"props":3969,"children":3970},{"style":153},[3971],{"type":41,"value":3972},"  await",{"type":28,"tag":130,"props":3974,"children":3975},{"style":143},[3976],{"type":41,"value":3977}," page.",{"type":28,"tag":130,"props":3979,"children":3980},{"style":159},[3981],{"type":41,"value":3982},"goto",{"type":28,"tag":130,"props":3984,"children":3985},{"style":143},[3986],{"type":41,"value":167},{"type":28,"tag":130,"props":3988,"children":3989},{"style":170},[3990],{"type":41,"value":3991},"\"https://playwright.dev\"",{"type":28,"tag":130,"props":3993,"children":3994},{"style":143},[3995],{"type":41,"value":2854},{"type":28,"tag":130,"props":3997,"children":3998},{"class":132,"line":498},[3999],{"type":28,"tag":130,"props":4000,"children":4001},{"style":552},[4002],{"type":41,"value":4003},"  // ... automate page interactions here\n",{"type":28,"tag":130,"props":4005,"children":4006},{"class":132,"line":517},[4007],{"type":28,"tag":130,"props":4008,"children":4009},{"style":143},[4010],{"type":41,"value":4011},"})()\n",{"type":28,"tag":29,"props":4013,"children":4014},{},[4015,4017,4022],{"type":41,"value":4016},"so for now we skip giving an overview of the ",{"type":28,"tag":44,"props":4018,"children":4020},{"className":4019},[],[4021],{"type":41,"value":3760},{"type":41,"value":4023}," code and defer it to a later post.",{"type":28,"tag":4025,"props":4026,"children":4027},"style",{},[4028],{"type":41,"value":4029},"html .default .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}",{"title":7,"searchDepth":353,"depth":353,"links":4031},[4032],{"id":287,"depth":353,"text":290,"children":4033},[4034,4035],{"id":1210,"depth":381,"text":1213},{"id":3631,"depth":381,"text":3634},"markdown","content:playwright:how-playwright-initializes.md","content","playwright/how-playwright-initializes.md","md",1711585380704]